import{x as Ge,r as d,f as X,g as He,p as Z,h as Ye,o as n,c as i,a as t,w as fe,v as he,y as xe,t as l,b as V,e as Le,F as W,i as ee,n as ze}from"./index-621cd5fc.js";import{clockinsApi as Ie}from"./clockins-c9805d20.js";import{h as te}from"./http-f1abb376.js";import{userSchedulesApi as qe}from"./userSchedules-3c685781.js";import{s as Fe,a as Je}from"./emailService-406cfe07.js";import{C as we}from"./auto-69f04699.js";const ke={totalHours:_=>te.get("/api/charts/hours",{query:_}),hoursByUser:(_,I)=>te.get(`/api/charts/user/${_}/hours`,{query:I}),sessionsByUser:(_,I)=>te.get(`/api/charts/user/${_}/sessions`,{query:I}),breaksByUser:(_,I)=>te.get(`/api/charts/user/${_}/breaks`,{query:I})};const Ke={class:"bg-white text-gray-800"},Qe={class:"flex justify-between items-center mb-8 flex-wrap gap-4"},Xe={class:"flex items-center gap-2"},Ze=["max"],et={class:"mt-6 p-6 bg-white border border-gray-200 rounded-xl shadow-sm"},tt={class:"flex flex-wrap items-center gap-4 mb-6"},ot=["disabled"],at={key:0,class:"ml-auto flex items-center gap-2 bg-gray-50 px-4 py-2 rounded-lg"},rt={class:"font-mono font-medium"},st={class:"text-sm text-gray-500"},lt={key:0,class:"p-4 text-center text-gray-500"},nt={key:1,class:"p-4 bg-red-50 text-red-700 rounded-lg mb-6"},it={key:2,class:"p-8 text-center text-gray-500"},ct={key:3,class:"overflow-x-auto"},dt={class:"mb-4 p-3 bg-gray-50 rounded-lg text-gray-700"},ut={class:"w-full border-separate border-spacing-0"},gt={key:0},yt={colspan:"3",class:"text-center py-4 px-4 border-b border-gray-200 text-gray-500"},pt={class:"whitespace-nowrap py-3 px-4 border-b border-gray-200 text-gray-800"},bt={class:"py-3 px-4 border-b border-gray-200"},vt={class:"whitespace-nowrap py-3 px-4 border-b border-gray-200"},mt=["href"],ft={key:1,class:"text-gray-400 text-sm"},ht={key:2},xt={class:"mt-6 p-6 bg-white border border-gray-200 rounded-xl shadow-sm"},wt={class:"flex flex-wrap items-center justify-between mb-4"},kt={class:"flex items-center gap-2"},_t=["max"],St={key:0,class:"p-4 text-center text-gray-500"},Dt={key:1,class:"p-4 text-center text-gray-500"},Tt={key:2,class:"overflow-x-auto"},Ct={class:"w-full border-separate border-spacing-0"},At={class:"whitespace-nowrap py-3 px-4 border-b border-gray-200 text-gray-800"},Lt={class:"text-right font-mono py-3 px-4 border-b border-gray-200 text-gray-800"},It={class:"text-right py-3 px-4 border-b border-gray-200 text-gray-800"},Ft={class:"font-medium bg-gray-50"},Ut={class:"text-right font-mono py-3 px-4 border-b border-gray-200"},Et={class:"text-right py-3 px-4 border-b border-gray-200"},Mt={class:"mt-6 p-6 bg-white border border-gray-200 rounded-xl shadow-sm"},Nt={key:0,class:"p-4 text-center text-gray-500"},$t={class:"overflow-x-auto"},Bt={class:"w-full border-separate border-spacing-0"},Ot={class:"whitespace-nowrap py-3 px-4 border-b border-gray-200 text-gray-800"},Pt={class:"whitespace-nowrap py-3 px-4 border-b border-gray-200 text-gray-800"},Rt={class:"py-3 px-4 border-b border-gray-200 text-gray-800"},Vt={class:"whitespace-nowrap py-3 px-4 border-b border-gray-200 text-gray-800"},Wt={class:"relative h-52 mt-6 bg-white rounded-lg border border-gray-200 p-4"},jt={class:"mt-6 p-6 bg-white border border-gray-200 rounded-xl shadow-sm"},Gt={class:"flex flex-wrap items-center justify-between mb-4"},Ht={class:"flex items-center gap-2"},Yt=["max"],zt={key:0,class:"p-4 text-center text-gray-500"},qt={class:"overflow-x-auto"},Jt={class:"w-full border-separate border-spacing-0"},Kt={class:"whitespace-nowrap py-3 px-4 border-b border-gray-200 text-gray-800"},Qt={class:"whitespace-nowrap py-3 px-4 border-b border-gray-200 text-gray-800"},Xt={class:"py-3 px-4 border-b border-gray-200 text-gray-800"},Zt={class:"whitespace-nowrap py-3 px-4 border-b border-gray-200 text-gray-800"},eo={key:0,class:"font-medium bg-gray-50"},to={class:"py-3 px-4 border-b border-gray-200"},oo={class:"whitespace-nowrap py-3 px-4 border-b border-gray-200"},ao={key:1,class:"font-medium bg-gray-50"},ro={class:"py-3 px-4 border-b border-gray-200"},so={class:"whitespace-nowrap py-3 px-4 border-b border-gray-200"},lo={key:2,class:"font-bold bg-gray-100"},no={class:"py-3 px-4 border-b border-gray-200"},io={class:"whitespace-nowrap py-3 px-4 border-b border-gray-200"},co={class:"relative h-52 mt-6 bg-white rounded-lg border border-gray-200 p-4"},uo={__name:"ClockinsView",setup(_){const I=async()=>{if(navigator.geolocation)try{console.log("🌍 Requesting browser geolocation...");const o=await new Promise((e,a)=>{navigator.geolocation.getCurrentPosition(r=>{console.log("✅ Browser geolocation successful:",r.coords),e(r)},r=>{console.warn("❌ Browser geolocation error:",r.message),r.code===1?console.warn("User denied geolocation permission"):r.code===2?console.warn("Position unavailable"):r.code===3&&console.warn("Geolocation timeout"),a(r)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})});return{latitude:o.coords.latitude,longitude:o.coords.longitude,accuracy:o.coords.accuracy,source:"browser_geolocation"}}catch(o){console.warn("⚠️ Browser geolocation failed, trying IP-based fallback",o.message)}else console.warn("⚠️ Navigator.geolocation not available in this browser");try{console.log("🌐 Trying IP-based geolocation...");const o=await fetch("https://ipapi.co/json/");if(o.ok){const e=await o.json();if(console.log("📍 IP geolocation response:",e),e.latitude&&e.longitude)return{latitude:parseFloat(e.latitude),longitude:parseFloat(e.longitude),city:e.city,region:e.region,country:e.country_name,source:"ip_geolocation"}}}catch(o){console.error("❌ IP-based geolocation failed",o)}return console.warn("⚠️ All location methods failed, proceeding without location"),{latitude:null,longitude:null,source:"none"}},w=d([]),F=d([]),oe=d(!1),y=d(""),U=d(!1),p=d(""),f=d(""),ae=d(!1),j=d([]),k=d([]),S=d([]),x=d(!1),D=d(null),h=d([]),E=d([]),g=d(""),_e=d(null),re=d(null),se=d(null);let le=null,ne=null,ie=null;const H=d(null),ce=d(0);let M=null,N=null,de=null;const Y=d([]),T=d(null),ue=()=>{const o=new Date,e=o.getFullYear(),a=String(o.getMonth()+1).padStart(2,"0"),r=String(o.getDate()).padStart(2,"0");return`${e}-${a}-${r}`},b=ue(),u=d(b),Se=new Date().toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),ge=()=>{const e=new Date().toLocaleDateString("en-US",{weekday:"long"}).toLowerCase();return Y.value.find(a=>a.day_of_week===e&&a.is_active)},$=o=>{const e=new Date,[a,r,c]=o.split(":");return e.setHours(parseInt(a),parseInt(r),parseInt(c||0),0),e},Ue=(o,e)=>{if(!e)return!1;const a=new Date(o);return $(e).getTime()-a.getTime()>30*60*1e3},Ee=(o,e)=>{if(!e)return!1;const a=new Date(o),r=$(e);return a.getTime()>r.getTime()},De=(o,e,a="warning")=>new Promise(r=>{const c=prompt(`${o}

${e}

Please provide a reason:`);r(c||"No reason provided")}),Me=()=>{const o=ge();if(!o||!o.scheduled_end_time)return;const e=$(o.scheduled_end_time),a=new Date,r=e.getTime()-a.getTime();console.log("🕐 Setting up clock out alert:",{scheduledEnd:e.toLocaleString(),now:a.toLocaleString(),timeUntilEnd:`${Math.floor(r/1e3/60)} minutes`}),r>0&&(N=setTimeout(()=>{Ne()},r))},Ne=()=>{if(!x.value||!T.value)return;confirm(`Your scheduled work hours have ended. Please clock out now.

Click OK to clock out, or Cancel to continue working.`)?Ce():(console.log("📧 User ignored clock out alert - sending email after 1 minute..."),setTimeout(()=>{x.value&&(console.log("📧 Sending forgot clock out email AFTER alert..."),$e())},6e4))},$e=async()=>{if(!(!T.value||!D.value))try{console.log("📧 Preparing to send forgot clock out email...");const o=ge(),e={clock_in_time:new Date(D.value).toLocaleTimeString(),expected_clock_out:(o==null?void 0:o.scheduled_end_time)||"Not set",current_time:new Date().toLocaleTimeString()};console.log("📧 Clock info for email:",e),console.log("📧 Sending to:",T.value.email),await Je(T.value,e),console.log("✅ Forgot clock out email sent successfully")}catch(o){console.error("❌ Failed to send forgot clock out email:",o)}},B=o=>{if(!o)return"--";const e=new Date(o);return isNaN(+e)?String(o):e.toLocaleString()},O=o=>{const e=Math.max(0,Math.floor(Number(o)||0)),a=Math.floor(e/60),r=e%60;return`${a}:${String(r).padStart(2,"0")}`},C=o=>{const e=Math.max(0,Math.floor(Number(o)||0)),a=Math.floor(e/3600),r=Math.floor(e%3600/60),c=e%60;return`${String(a).padStart(2,"0")}:${String(r).padStart(2,"0")}:${String(c).padStart(2,"0")}`},Te=o=>{G(),H.value=o;const e=Date.parse(o);M=setInterval(()=>{ce.value=Math.max(0,Math.floor((Date.now()-e)/1e3))},1e3)},G=()=>{M&&clearInterval(M),M=null,H.value=null,ce.value=0},ye=X(()=>u.value?u.value===b?`Today, ${Se}`:new Date(u.value).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):Se),pe=()=>{u.value&&(f.value=u.value,J()),be()},be=()=>{u.value||(u.value=b),console.log("🔵 Filtering clock-ins for date:",u.value),console.log("🔵 Available clock-ins:",w.value.length),F.value=w.value.filter(o=>{if(!o.time)return!1;const a=new Date(o.time).toISOString().split("T")[0];return console.log("🔵 Clock-in time:",o.time,"→ Local date:",a,"vs Selected:",u.value),a===u.value}),console.log("🔵 Filtered clock-ins count:",F.value.length)},ve=()=>{try{g.value||(g.value=b),console.log("🔵 Filtering sessions/breaks for date:",g.value),console.log("🔵 Available sessions:",S.value.length),console.log("🔵 Available breaks:",k.value.length);const o=g.value;h.value=S.value.filter(e=>{if(!(e!=null&&e.start))return!1;try{const r=new Date(e.start).toISOString().split("T")[0],c=r===o;return c&&console.log("🔵 Matching session found:",e.start,"→",r),c}catch(a){return console.error("Error parsing session date:",e.start,a),!1}}),E.value=k.value.filter(e=>{if(!(e!=null&&e.start))return!1;try{const r=new Date(e.start).toISOString().split("T")[0],c=r===o;return c&&console.log("🔵 Matching break found:",e.start,"→",r),c}catch(a){return console.error("Error parsing break date:",e.start,a),!1}}),console.log("🔵 Filtered sessions count:",h.value.length),console.log("🔵 Filtered breaks count:",E.value.length),K()}catch(o){console.error("Error in filterSessionsAndBreaks:",o)}},Be=X(()=>g.value?g.value===b?"today":new Date(g.value).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):"selected date"),z=X(()=>h.value.reduce((o,e)=>{const a=e.seconds?e.seconds/60:e.minutes||0;return o+a},0)),q=X(()=>E.value.reduce((o,e)=>{const a=e.seconds?e.seconds/60:e.minutes||0;return o+a},0)),me=async()=>{oe.value=!0,y.value="";try{if(!p.value){w.value=[],F.value=[],S.value=[],h.value=[],x.value=!1,D.value=null,G();return}const o=await Ie.listByUser(p.value),e=Array.isArray(o==null?void 0:o.data)?o.data:Array.isArray(o)?o:[];if(w.value=e,w.value.length>0){const a=w.value[0];x.value=a.status===!0,x.value?(D.value=a.time,Te(a.time)):(D.value=null,G());const r=new Date(a.time).toISOString().split("T")[0];u.value?(console.log("🔵 Using selected date:",u.value),f.value=u.value,g.value=u.value):(console.log("🔵 No date selected, switching to most recent data date:",r),u.value=r,f.value=r,g.value=r)}else x.value=!1,D.value=null,G();be()}catch{y.value="Failed to load clockins"}finally{oe.value=!1}},J=async()=>{if(!p.value){j.value=[],k.value=[],S.value=[],await Z(),K();return}f.value||(f.value=b),g.value!==f.value&&(g.value=f.value),ae.value=!0;try{const o={date:f.value},[e,a,r]=await Promise.all([ke.hoursByUser(p.value,o),ke.breaksByUser(p.value,o),ke.sessionsByUser(p.value,o)]);j.value=Array.isArray(e==null?void 0:e.data)?e.data:[],k.value=Array.isArray(a==null?void 0:a.data)?a.data:[],S.value=Array.isArray(r==null?void 0:r.data)?r.data:[],ve(),await Z(),K()}catch(o){console.error("Error loading charts data:",o),j.value=[],k.value=[],S.value=[],h.value=[],E.value=[],await Z(),K()}finally{ae.value=!1}},K=()=>{const o=j.value.map(s=>s.date),e=j.value.map(s=>s.seconds||s.minutes*60);le&&le.destroy(),_e.value&&(le=new we(_e.value.getContext("2d"),{type:"line",data:{labels:o,datasets:[{label:"Working Time",data:e,borderColor:"#60a5fa",backgroundColor:"rgba(96,165,250,0.2)",tension:.3}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{ticks:{callback:function(s){return O(s)}}}},plugins:{tooltip:{callbacks:{label:s=>` ${O(s.parsed.y)}`}}}}}));const a=k.value.map(s=>new Date(s.start).toLocaleTimeString()),r=k.value.map(s=>s.seconds||s.minutes*60);ne&&ne.destroy(),re.value&&(ne=new we(re.value.getContext("2d"),{type:"line",data:{labels:a,datasets:[{label:"Break Duration",data:r,borderColor:"#f87171",backgroundColor:"rgba(248,113,113,0.2)",tension:.3}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{ticks:{callback:function(s){return O(s)}}}},plugins:{tooltip:{callbacks:{label:s=>` ${O(s.parsed.y)}`}}}}}));const c=S.value.map(s=>new Date(s.start).toLocaleTimeString()),v=S.value.map(s=>s.seconds||s.minutes*60);ie&&ie.destroy(),se.value&&(ie=new we(se.value.getContext("2d"),{type:"line",data:{labels:c,datasets:[{label:"Session Duration",data:v,borderColor:"#34d399",backgroundColor:"rgba(52,211,153,0.2)",tension:.3}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{ticks:{callback:function(s){return O(s)}}}},plugins:{tooltip:{callbacks:{label:s=>` ${O(s.parsed.y)}`}}}}}))},Ce=async()=>{if(console.log("🚀🚀🚀 TOGGLE FUNCTION CALLED - NEW VERSION WITH ALERTS! 🚀🚀🚀"),console.log("🔵 Toggle function called"),console.log("🔵 Creating state:",U.value),console.log("🔵 Current user ID:",p.value),U.value){console.log("🔴 Already creating, returning early");return}U.value=!0,y.value="",console.log("🔵 Starting toggle process...");let o={latitude:null,longitude:null},e="none";const a=await I();o={latitude:a.latitude,longitude:a.longitude},e=a.source,console.log("📍 Location data from getLocation():",a),console.log(`📍 Using location from ${a.source}:`,o),e==="browser_geolocation"?console.log("✅ Using precise GPS location"):e==="ip_geolocation"?(console.log("⚠️ Using approximate location based on IP address"),y.value="Using approximate location (IP-based). For precise location, enable GPS in your browser.",setTimeout(()=>{y.value.includes("approximate location")&&(y.value="")},5e3)):(console.log("❌ No location data available"),y.value="Location not available. Clock in/out will proceed without location data.",setTimeout(()=>{y.value.includes("Location not available")&&(y.value="")},5e3));try{if(!p.value){console.log("🔴 No user ID found!"),y.value="No user ID found. Please refresh the page.";return}console.log("🔵 User ID found:",p.value);const r={latitude:o.latitude,longitude:o.longitude};console.log("🔵 Sending location data to server:",r),console.log("🔵 Making API call to clockinsApi.toggleForUser...");const c=await Ie.toggleForUser(p.value,r);console.log("🔵 Server response received:",c),c&&c.data&&(console.log("Response data:",c.data),console.log("Clock record:",c.data),c.data.latitude&&c.data.longitude?console.log("Location data in response:",{latitude:c.data.latitude,longitude:c.data.longitude}):console.warn("No location data in response"));const v=new Date().toISOString(),s=!x.value,A=(c==null?void 0:c.data)||{},We={id:A.id||`temp-${Date.now()}`,time:A.time||v,status:A.status!==void 0?A.status:s,user_id:p.value,latitude:A.latitude!==void 0?A.latitude:o.latitude,longitude:A.longitude!==void 0?A.longitude:o.longitude};if(w.value=[We,...w.value],be(),x.value=s,s){console.log("🟢 Clock In - Starting session"),D.value=v,Te(v);const m=ge(),je=new Date().toLocaleDateString("en-US",{weekday:"long"}).toLowerCase();if(console.log("🔍 Current day:",je),console.log("🔍 All schedules:",Y.value),console.log("🔍 Schedule found for today:",m),console.log("🔍 Current user:",T.value),m&&m.scheduled_start_time){console.log("✅ Schedule has start time:",m.scheduled_start_time);const Ae=Ue(v,m.scheduled_start_time);if(console.log("🕐 Is early arrival?",Ae),Ae){const Q=$(m.scheduled_start_time);console.log("🌅 EARLY ARRIVAL DETECTED!");const P=await De("🌅 Early Arrival Detected",`You're clocking in early today!

Scheduled start: ${Q.toLocaleTimeString()}
Actual start: ${new Date(v).toLocaleTimeString()}`);console.log("📝 User reason:",P),console.log("📧 Sending early arrival email AFTER alert response...");try{const L=$(m.scheduled_start_time),R={scheduled_start:L.toLocaleTimeString(),actual_start:new Date(v).toLocaleTimeString(),early_minutes:Math.floor((L.getTime()-new Date(v).getTime())/(1e3*60)),reason:P};console.log("📧 Email data:",R),await Fe(T.value,R),console.log("✅ Early arrival email sent successfully AFTER alert")}catch(L){console.error("❌ Failed to send early arrival email:",L)}}if(m.scheduled_end_time){const Q=Ee(v,m.scheduled_end_time);if(console.log("🕐 Is late arrival?",Q),Q){const P=$(m.scheduled_end_time);console.log("⚠️ LATE ARRIVAL DETECTED!");const L=await De("⚠️ Late Clock In",`You're clocking in after your scheduled end time!

Scheduled end: ${P.toLocaleTimeString()}
Actual clock in: ${new Date(v).toLocaleTimeString()}`);console.log("📝 Late clock in reason:",L),console.log("📧 Sending late arrival email AFTER alert response...");try{const R={scheduled_end:P.toLocaleTimeString(),actual_clock_in:new Date(v).toLocaleTimeString(),reason:L};console.log("📧 Late arrival email data:",R),await Fe(T.value,{scheduled_start:"Late Clock In",actual_start:new Date(v).toLocaleTimeString(),early_minutes:Math.floor((new Date(v).getTime()-P.getTime())/(1e3*60)),reason:L}),console.log("✅ Late arrival email sent successfully")}catch(R){console.error("❌ Failed to send late arrival email:",R)}}}Me()}else console.log("⚠️ No schedule found for today or missing start time"),console.log("⚠️ Cannot set up alerts without schedule"),console.log("ℹ️ Please set up your work schedule to enable email alerts")}else console.log("🔴 Clock Out - Ending session"),D.value=null,G(),N&&(clearTimeout(N),N=null);setTimeout(()=>{me().catch(m=>console.error("Background refresh failed:",m)),J().catch(m=>console.error("Charts refresh failed:",m))},500)}catch(r){console.error("🔴 Error toggling clock status:",r),console.error("🔴 Error details:",{message:r.message,status:r.status,body:r.body}),x.value=!x.value}finally{console.log("🔵 Setting creating state to false"),U.value=!1}},Oe=()=>{ve()},Pe=()=>{const o=ue();console.log("🔵 Switching to today:",o),u.value=o,f.value=o,g.value=o,pe()},Re=()=>{const o=ue();u.value!==o&&(console.log("🔵 Day has changed, updating to today:",o),u.value=o,f.value=o,g.value=o,pe())},Ve=async()=>{try{if(p.value){const o=await qe.listByUser(p.value);Y.value=o.data||[],console.log("User schedules loaded:",Y.value)}}catch(o){console.error("Failed to load user schedules:",o)}};return He(async()=>{console.log("🔵 ClockinsView mounted"),console.log("🔵 Today date:",b);try{const o=localStorage.getItem("currentUser");console.log("🔵 Raw user data from localStorage:",o);const e=JSON.parse(o||"null");console.log("🔵 Parsed user data:",e),e!=null&&e.id?(console.log("🔵 User ID found, setting currentUserId:",e.id),p.value=e.id,T.value=e,u.value=b,f.value=b,g.value=b,console.log("🔵 Initialized dates to today:",b),await me(),await Ve(),await Z(),await J(),de=setInterval(Re,5*60*1e3)):(console.log("🔴 No user ID found in localStorage"),y.value="User not authenticated. Please log in again.",ve())}catch(o){console.error("🔴 Failed to load user data:",o),y.value="Failed to load user data. Please refresh the page."}}),Ye(()=>{M&&clearInterval(M),N&&clearTimeout(N),de&&clearInterval(de)}),(o,e)=>(n(),i("section",Ke,[t("div",Qe,[e[4]||(e[4]=t("div",null,[t("h1",{class:"text-3xl font-bold text-gray-900 m-0"},"Time Tracking"),t("p",{class:"text-gray-500 text-sm"},"Manage your work hours and clock in/out")],-1)),t("div",Xe,[e[3]||(e[3]=t("label",{for:"date-filter",class:"text-sm text-gray-600 mr-2"},"View Date:",-1)),fe(t("input",{type:"date",id:"date-filter","onUpdate:modelValue":e[0]||(e[0]=a=>u.value=a),max:xe(b),class:"border border-gray-300 rounded-md py-1 px-2 text-sm focus:outline-none focus:border-blue-600 focus:ring focus:ring-blue-600 focus:ring-opacity-10",onChange:pe},null,40,Ze),[[he,u.value]])])]),t("div",et,[e[11]||(e[11]=t("div",{class:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4"},[t("p",{class:"text-sm text-blue-800 font-medium"},"📋 Official Attendance Tracking"),t("p",{class:"text-xs text-blue-700"},"This is for official clock in/out attendance. Includes early/late arrival alerts and automatic clock-out reminders.")],-1)),e[12]||(e[12]=t("h2",{class:"text-xl font-semibold text-gray-900 m-0 mb-4"},"Clock In/Out (Official Attendance)",-1)),t("div",tt,[t("button",{onClick:Ce,class:"px-4 py-2 rounded-lg font-medium transition-all duration-200 cursor-pointer bg-blue-600 text-white border border-blue-600 hover:bg-blue-700 hover:border-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",disabled:U.value},l(U.value?"Processing...":x.value?"Clock Out":"Clock In"),9,ot),t("button",{type:"button",onClick:me,class:"px-4 py-2 rounded-lg font-medium transition-all duration-200 cursor-pointer bg-white border border-gray-300 text-gray-700 hover:bg-gray-50 hover:border-gray-400"}," Refresh "),t("button",{type:"button",onClick:Pe,class:"px-4 py-2 rounded-lg font-medium transition-all duration-200 cursor-pointer bg-green-600 text-white border border-green-600 hover:bg-green-700 hover:border-green-700"}," Today "),H.value?(n(),i("div",at,[e[5]||(e[5]=t("div",{class:"w-3 h-3 rounded-full bg-green-500 animate-pulse"},null,-1)),e[6]||(e[6]=t("span",{class:"text-sm font-medium"},"Active session:",-1)),t("span",rt,l(C(ce.value)),1),t("span",st,"since "+l(B(H.value)),1)])):V("",!0)]),oe.value?(n(),i("div",lt," Loading clock-in data... ")):y.value?(n(),i("div",nt,l(y.value),1)):V("",!0),F.value.length===0?(n(),i("div",it," No clock-in/out records found for "+l(ye.value),1)):(n(),i("div",ct,[t("div",dt,[e[7]||(e[7]=Le(" Showing records for: ",-1)),t("strong",null,l(ye.value),1)]),t("table",ut,[e[10]||(e[10]=t("thead",null,[t("tr",null,[t("th",{class:"text-left py-3 px-4 border-b border-gray-200 bg-gray-50 font-semibold text-gray-700 uppercase text-xs tracking-wider"},"Time"),t("th",{class:"text-left py-3 px-4 border-b border-gray-200 bg-gray-50 font-semibold text-gray-700 uppercase text-xs tracking-wider"},"Status"),t("th",{class:"text-left py-3 px-4 border-b border-gray-200 bg-gray-50 font-semibold text-gray-700 uppercase text-xs tracking-wider"},"Location")])],-1)),t("tbody",null,[F.value.length===0?(n(),i("tr",gt,[t("td",yt," No clock-in/out records found for "+l(ye.value),1)])):(n(!0),i(W,{key:1},ee(F.value,a=>(n(),i("tr",{key:a.id,class:"hover:bg-gray-50"},[t("td",pt,l(B(a.time)),1),t("td",bt,[t("span",{class:ze(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",a.status?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"])},l(a.status?"Clocked In":"Clocked Out"),3)]),t("td",vt,[a.latitude&&a.longitude?(n(),i("a",{key:0,href:`https://www.google.com/maps?q=${a.latitude},${a.longitude}`,target:"_blank",class:"text-blue-600 hover:underline flex items-center",title:"View on Google Maps"},[...e[8]||(e[8]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})],-1),Le(" View Location ",-1)])],8,mt)):(n(),i("span",ft,"No location data"))])]))),128)),w.value.length===0?(n(),i("tr",ht,[...e[9]||(e[9]=[t("td",{colspan:"3",class:"text-center py-4 px-4 border-b border-gray-200 text-gray-500"}," No clock-in records found ",-1)])])):V("",!0)])])]))]),t("div",xt,[t("div",wt,[e[14]||(e[14]=t("h2",{class:"text-xl font-semibold text-gray-900 m-0"},"Working Time Summary",-1)),t("div",kt,[e[13]||(e[13]=t("label",{class:"text-sm text-gray-600"},"Filter by date:",-1)),fe(t("input",{type:"date","onUpdate:modelValue":e[1]||(e[1]=a=>f.value=a),onChange:J,max:xe(b),class:"border border-gray-300 rounded-md py-1 px-2 text-sm focus:outline-none focus:border-blue-600 focus:ring focus:ring-blue-600 focus:ring-opacity-10"},null,40,_t),[[he,f.value]])])]),ae.value?(n(),i("div",St," Loading charts... ")):h.value.length===0?(n(),i("div",Dt," No working time data available for the selected period. ")):(n(),i("div",Tt,[t("table",Ct,[e[16]||(e[16]=t("thead",null,[t("tr",null,[t("th",{class:"whitespace-nowrap text-left py-3 px-4 border-b border-gray-200 bg-gray-50 font-semibold text-gray-700 uppercase text-xs tracking-wider"},"Date"),t("th",{class:"text-right py-3 px-4 border-b border-gray-200 bg-gray-50 font-semibold text-gray-700 uppercase text-xs tracking-wider"},"Duration"),t("th",{class:"text-right py-3 px-4 border-b border-gray-200 bg-gray-50 font-semibold text-gray-700 uppercase text-xs tracking-wider"},"Hours")])],-1)),t("tbody",null,[(n(!0),i(W,null,ee(h.value,a=>(n(),i("tr",{key:a.start,class:"hover:bg-gray-50"},[t("td",At,l(new Date(a.start).toISOString().split("T")[0]),1),t("td",Lt,l(C(a.seconds||0)),1),t("td",It,l(((a.seconds||0)/3600).toFixed(1))+"h",1)]))),128)),t("tr",Ft,[e[15]||(e[15]=t("td",{class:"py-3 px-4 border-b border-gray-200"},"Total",-1)),t("td",Ut,l(C(h.value.reduce((a,r)=>a+(r.seconds||0),0))),1),t("td",Et,l((h.value.reduce((a,r)=>a+(r.seconds||0),0)/3600).toFixed(1))+"h ",1)])])])]))]),t("div",Mt,[e[18]||(e[18]=t("h2",{class:"text-xl font-semibold text-gray-900 m-0 mb-4"},"Breaks",-1)),k.value.length===0?(n(),i("div",Nt," No break data available. ")):(n(),i(W,{key:1},[t("div",$t,[t("table",Bt,[e[17]||(e[17]=t("thead",null,[t("tr",null,[t("th",{class:"text-left py-3 px-4 border-b border-gray-200 bg-gray-50 font-semibold text-gray-700 uppercase text-xs tracking-wider"},"Start"),t("th",{class:"text-left py-3 px-4 border-b border-gray-200 bg-gray-50 font-semibold text-gray-700 uppercase text-xs tracking-wider"},"End"),t("th",{class:"text-left py-3 px-4 border-b border-gray-200 bg-gray-50 font-semibold text-gray-700 uppercase text-xs tracking-wider"},"Minutes"),t("th",{class:"text-left py-3 px-4 border-b border-gray-200 bg-gray-50 font-semibold text-gray-700 uppercase text-xs tracking-wider"},"Duration")])],-1)),t("tbody",null,[(n(!0),i(W,null,ee(k.value,(a,r)=>(n(),i("tr",{key:r,class:"hover:bg-gray-50"},[t("td",Ot,l(B(a.start)),1),t("td",Pt,l(B(a.end)),1),t("td",Rt,l(a.seconds?(a.seconds/60).toFixed(2):a.minutes),1),t("td",Vt,l(C(a.seconds??a.minutes*60)),1)]))),128))])])]),t("div",Wt,[t("canvas",{ref_key:"breaksCanvas",ref:re,height:"120"},null,512)])],64))]),t("div",jt,[t("div",Gt,[e[20]||(e[20]=t("h2",{class:"text-xl font-semibold text-gray-900 m-0"},"Working Sessions",-1)),t("div",Ht,[e[19]||(e[19]=t("label",{class:"text-sm text-gray-600"},"Filter by date:",-1)),fe(t("input",{type:"date","onUpdate:modelValue":e[2]||(e[2]=a=>g.value=a),onChange:Oe,max:xe(b),class:"border border-gray-300 rounded-md py-1 px-2 text-sm focus:outline-none focus:border-blue-600 focus:ring focus:ring-blue-600 focus:ring-opacity-10"},null,40,Yt),[[he,g.value]])])]),h.value.length===0?(n(),i("div",zt," No session data available for "+l(Be.value)+". ",1)):(n(),i(W,{key:1},[t("div",qt,[t("table",Jt,[e[24]||(e[24]=t("thead",null,[t("tr",null,[t("th",{class:"text-left py-3 px-4 border-b border-gray-200 bg-gray-50 font-semibold text-gray-700 uppercase text-xs tracking-wider"},"Start"),t("th",{class:"text-left py-3 px-4 border-b border-gray-200 bg-gray-50 font-semibold text-gray-700 uppercase text-xs tracking-wider"},"End"),t("th",{class:"text-left py-3 px-4 border-b border-gray-200 bg-gray-50 font-semibold text-gray-700 uppercase text-xs tracking-wider"},"Minutes"),t("th",{class:"text-left py-3 px-4 border-b border-gray-200 bg-gray-50 font-semibold text-gray-700 uppercase text-xs tracking-wider"},"Duration")])],-1)),t("tbody",null,[(n(!0),i(W,null,ee(h.value,(a,r)=>(n(),i("tr",{key:r,class:"hover:bg-gray-50"},[t("td",Kt,l(B(a.start)),1),t("td",Qt,l(B(a.end)),1),t("td",Xt,l(a.seconds?(a.seconds/60).toFixed(2):a.minutes),1),t("td",Zt,l(C(a.seconds??a.minutes*60)),1)]))),128)),h.value.length>0?(n(),i("tr",eo,[e[21]||(e[21]=t("td",{colspan:"2",class:"text-right pr-4 py-3 px-4 border-b border-gray-200"},"Total Work Time:",-1)),t("td",to,l(z.value.toFixed(2)),1),t("td",oo,l(C(z.value*60)),1)])):V("",!0),E.value.length>0?(n(),i("tr",ao,[e[22]||(e[22]=t("td",{colspan:"2",class:"text-right pr-4 py-3 px-4 border-b border-gray-200"},"Total Break Time:",-1)),t("td",ro,l(q.value.toFixed(2)),1),t("td",so,l(C(q.value*60)),1)])):V("",!0),h.value.length>0||E.value.length>0?(n(),i("tr",lo,[e[23]||(e[23]=t("td",{colspan:"2",class:"text-right pr-4 py-3 px-4 border-b border-gray-200"},"Total Time (Work + Break):",-1)),t("td",no,l((z.value+q.value).toFixed(2)),1),t("td",io,l(C((z.value+q.value)*60)),1)])):V("",!0)])])]),t("div",co,[t("canvas",{ref_key:"sessionsCanvas",ref:se,height:"120"},null,512)])],64))])]))}},fo=Ge(uo,[["__scopeId","data-v-e26ca392"]]);export{fo as default};
