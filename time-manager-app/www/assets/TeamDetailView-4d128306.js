import{t as c}from"./teams-c229c1dd.js";import{u as _}from"./users-adcbd397.js";import{x as M,o as a,c as n,a as t,e as g,b as u,t as l,F as b,i as v,j as w,w as k,v as T,k as E}from"./index-5e39243b.js";import"./http-8cebfae0.js";const A={name:"TeamDetailView",data(){return{team:null,availableEmployees:[],loading:!1,updating:!1,addingMember:!1,showEditModal:!1,showAddMemberModal:!1,editTeam:{description:""},newEmployeeId:""}},computed:{teamId(){return this.$route.params.id},user(){return JSON.parse(localStorage.getItem("currentUser")||"{}")},userRole(){return this.user.role||"employee"},canManageTeam(){return this.team&&c.canManageTeam(this.team)}},async created(){await this.loadTeam(),await this.loadAvailableEmployees()},methods:{async loadTeam(){var r;try{this.loading=!0,console.log("Loading team with ID:",this.teamId);const e=await c.get(this.teamId);console.log("Team API response:",e);const i=e.data||e;console.log("Team data extracted:",i),this.team=i,console.log("Team loaded successfully:",this.team)}catch(e){console.error("Error loading team:",e),(r=this.$toast)==null||r.error("Failed to load team"),this.team=null}finally{this.loading=!1}},async loadAvailableEmployees(){try{const r=await _.list(),e=r.data||r||[],i=[];this.team&&this.team.employees&&Array.isArray(this.team.employees)&&this.team.employees.forEach(m=>{m&&m.id&&i.push(m.id)}),this.availableEmployees=e.filter(m=>m.role==="employee"&&!i.includes(m.id))}catch(r){console.error("Error loading employees:",r),this.availableEmployees=[]}},async updateTeam(){var r,e;try{this.updating=!0,await c.update(this.teamId,this.editTeam),this.showEditModal=!1,await this.loadTeam(),(r=this.$toast)==null||r.success("Team updated successfully")}catch(i){console.error("Error updating team:",i),(e=this.$toast)==null||e.error("Failed to update team")}finally{this.updating=!1}},async addEmployee(){var r,e;try{this.addingMember=!0,await c.addEmployee(this.teamId,this.newEmployeeId),this.showAddMemberModal=!1,this.newEmployeeId="",await this.loadTeam(),await this.loadAvailableEmployees(),(r=this.$toast)==null||r.success("Member added successfully")}catch(i){console.error("Error adding member:",i),(e=this.$toast)==null||e.error("Failed to add member")}finally{this.addingMember=!1}},async removeEmployee(r){var e,i;if(confirm("Are you sure you want to remove this member from the team?"))try{await c.removeEmployee(this.teamId,r),await this.loadTeam(),await this.loadAvailableEmployees(),(e=this.$toast)==null||e.success("Member removed successfully")}catch(m){console.error("Error removing member:",m),(i=this.$toast)==null||i.error("Failed to remove member")}},goBackToTeams(){(JSON.parse(localStorage.getItem("currentUser")||"{}").role||"employee")==="admin"?this.$router.push("/admin/teams"):this.$router.push("/teams")}}},I={class:"p-6 max-w-7xl mx-auto bg-white"},j={class:"flex items-center justify-between mb-6"},C={class:"flex items-center gap-4"},B={key:0,class:"flex gap-3"},U={key:0,class:"flex justify-center items-center py-12"},S={key:1,class:"space-y-6"},D={class:"bg-white border border-gray-200 rounded-lg shadow-sm"},N={class:"p-6"},V={class:"flex items-start justify-between mb-6"},z={class:"text-xl font-semibold text-gray-900"},F={class:"text-sm text-gray-500 mt-1"},L={class:"flex items-center gap-2"},H={class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800"},R={key:0,class:"mb-6"},q={class:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg"},J={class:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center"},O={class:"text-sm font-medium text-blue-600"},P={class:"text-sm font-medium text-gray-900"},G={class:"text-sm text-gray-500"},K={class:"bg-white border border-gray-200 rounded-lg shadow-sm"},Q={class:"p-6"},W={class:"flex items-center justify-between mb-6"},X={key:0,class:"space-y-3"},Y={class:"flex items-center gap-3"},Z={class:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center"},$={class:"text-xs font-medium text-green-600"},ee={class:"text-sm font-medium text-gray-900"},te={class:"text-sm text-gray-500"},se={class:"flex items-center gap-2"},oe=["onClick"],re={key:1,class:"text-center py-8"},ae={key:2,class:"text-center py-12"},ne={key:3,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},ie={class:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white"},le={class:"mt-3"},de={class:"flex justify-end space-x-3 pt-4"},me=["disabled"],ue={key:4,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},ce={class:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white"},ge={class:"mt-3"},pe=["value"],ye={class:"flex justify-end space-x-3 pt-4"},fe=["disabled"];function xe(r,e,i,m,o,d){var p,y,f;return a(),n("section",I,[t("div",j,[t("div",C,[t("button",{onClick:e[0]||(e[0]=(...s)=>d.goBackToTeams&&d.goBackToTeams(...s)),class:"flex items-center gap-2 text-gray-600 hover:text-gray-900"},[...e[9]||(e[9]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1),g(" Back to Teams ",-1)])]),e[10]||(e[10]=t("div",{class:"h-6 w-px bg-gray-300"},null,-1)),e[11]||(e[11]=t("h1",{class:"text-2xl font-bold text-gray-900"},"Team Management",-1))]),d.canManageTeam?(a(),n("div",B,[d.canManageTeam?(a(),n("button",{key:0,onClick:e[1]||(e[1]=s=>o.showEditModal=!0),class:"flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white text-sm font-medium rounded-lg hover:bg-indigo-700"},[...e[12]||(e[12]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1),g(" Edit Team ",-1)])])):u("",!0)])):u("",!0)]),o.loading?(a(),n("div",U,[...e[13]||(e[13]=[t("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"},null,-1)])])):o.team?(a(),n("div",S,[t("div",D,[t("div",N,[t("div",V,[t("div",null,[t("h2",z,l(o.team.description||"Unnamed Team"),1),t("p",F,"Team ID: "+l(o.team.id),1)]),t("div",L,[t("span",H,l(((p=o.team.employees)==null?void 0:p.length)||0)+" members ",1)])]),o.team.manager?(a(),n("div",R,[e[15]||(e[15]=t("h3",{class:"text-sm font-medium text-gray-900 mb-3"},"Team Manager",-1)),t("div",q,[t("div",J,[t("span",O,l(((y=o.team.manager.first_name)==null?void 0:y[0])||((f=o.team.manager.username)==null?void 0:f[0])||"M"),1)]),t("div",null,[t("p",P,l(o.team.manager.first_name&&o.team.manager.last_name?`${o.team.manager.first_name} ${o.team.manager.last_name}`:o.team.manager.username||"Unknown Manager"),1),t("p",G,l(o.team.manager.email),1)]),e[14]||(e[14]=t("div",{class:"ml-auto"},[t("span",{class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800"}," Manager ")],-1))])])):u("",!0)])]),t("div",K,[t("div",Q,[t("div",W,[e[17]||(e[17]=t("h3",{class:"text-lg font-medium text-gray-900"},"Team Members",-1)),d.canManageTeam?(a(),n("button",{key:0,onClick:e[2]||(e[2]=s=>o.showAddMemberModal=!0),class:"flex items-center gap-2 px-3 py-2 bg-green-600 text-white text-sm font-medium rounded-md hover:bg-green-700"},[...e[16]||(e[16]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1),g(" Add Member ",-1)])])):u("",!0)]),o.team.employees&&o.team.employees.length>0?(a(),n("div",X,[(a(!0),n(b,null,v(o.team.employees,s=>{var x,h;return a(),n("div",{key:s.id,class:"flex items-center justify-between p-3 bg-gray-50 rounded-lg"},[t("div",Y,[t("div",Z,[t("span",$,l(((x=s.first_name)==null?void 0:x[0])||((h=s.username)==null?void 0:h[0])||"E"),1)]),t("div",null,[t("p",ee,l(s.first_name&&s.last_name?`${s.first_name} ${s.last_name}`:s.username||"Unknown Employee"),1),t("p",te,l(s.email),1)])]),t("div",se,[e[19]||(e[19]=t("span",{class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800"}," Employee ",-1)),d.canManageTeam?(a(),n("button",{key:0,onClick:he=>d.removeEmployee(s.id),class:"p-1 text-red-600 hover:text-red-900 hover:bg-red-50 rounded"},[...e[18]||(e[18]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,oe)):u("",!0)])])}),128))])):(a(),n("div",re,[...e[20]||(e[20]=[t("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"})],-1),t("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No team members",-1),t("p",{class:"mt-1 text-sm text-gray-500"},"Add employees to get started.",-1)])]))])])])):(a(),n("div",ae,[...e[21]||(e[21]=[t("svg",{class:"mx-auto h-12 w-12 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})],-1),t("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"Team not found",-1),t("p",{class:"mt-1 text-sm text-gray-500"},"The team you're looking for doesn't exist or you don't have permission to view it.",-1)])])),o.showEditModal?(a(),n("div",ne,[t("div",ie,[t("div",le,[e[23]||(e[23]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Edit Team",-1)),t("form",{onSubmit:e[5]||(e[5]=w((...s)=>d.updateTeam&&d.updateTeam(...s),["prevent"])),class:"space-y-4"},[t("div",null,[e[22]||(e[22]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Team Name",-1)),k(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>o.editTeam.description=s),type:"text",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",placeholder:"Enter team name"},null,512),[[T,o.editTeam.description]])]),t("div",de,[t("button",{type:"button",onClick:e[4]||(e[4]=s=>o.showEditModal=!1),class:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50"}," Cancel "),t("button",{type:"submit",disabled:o.updating,class:"px-4 py-2 bg-indigo-600 border border-transparent rounded-md text-sm font-medium text-white hover:bg-indigo-700 disabled:opacity-50"},l(o.updating?"Updating...":"Update Team"),9,me)])],32)])])])):u("",!0),o.showAddMemberModal?(a(),n("div",ue,[t("div",ce,[t("div",ge,[e[26]||(e[26]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Add Team Member",-1)),t("form",{onSubmit:e[8]||(e[8]=w((...s)=>d.addEmployee&&d.addEmployee(...s),["prevent"])),class:"space-y-4"},[t("div",null,[e[25]||(e[25]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Select Employee",-1)),k(t("select",{"onUpdate:modelValue":e[6]||(e[6]=s=>o.newEmployeeId=s),required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"},[e[24]||(e[24]=t("option",{value:""},"Select an employee",-1)),(a(!0),n(b,null,v(o.availableEmployees,s=>(a(),n("option",{key:s.id,value:s.id},l(s.first_name&&s.last_name?`${s.first_name} ${s.last_name}`:s.username||"Unknown Employee")+" ("+l(s.username)+") ",9,pe))),128))],512),[[E,o.newEmployeeId]])]),t("div",ye,[t("button",{type:"button",onClick:e[7]||(e[7]=s=>o.showAddMemberModal=!1),class:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50"}," Cancel "),t("button",{type:"submit",disabled:o.addingMember,class:"px-4 py-2 bg-green-600 border border-transparent rounded-md text-sm font-medium text-white hover:bg-green-700 disabled:opacity-50"},l(o.addingMember?"Adding...":"Add Member"),9,fe)])],32)])])])):u("",!0)])}const _e=M(A,[["render",xe]]);export{_e as default};
