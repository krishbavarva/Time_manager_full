import{workingTimesApi as _}from"./workingTimes-d509afa4.js";import{r as g,f as l,g as H,o as W,c as $,a as o,t as N,e as w}from"./index-621cd5fc.js";import"./http-f1abb376.js";const B={class:"min-h-screen bg-gray-50 py-8 px-4 sm:px-6 lg:px-8"},E={class:"max-w-7xl mx-auto"},O={class:"mb-8"},V={class:"flex items-center justify-between"},C={class:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6"},I={class:"flex items-center justify-between"},j={class:"text-3xl font-bold text-orange-600"},F={class:"mt-6 bg-blue-50 border border-blue-200 rounded-lg p-4"},G={class:"flex items-start"},L={__name:"WorkingTimesView",setup(U){const i=g(new Date),d=g([]);g(!1),l(()=>{const t=u(i.value),e=f(i.value);return`${v(t)} - ${v(e)}`}),l(()=>{const t=u(i.value);return D(t)});const p=l(()=>d.value.reduce((t,e)=>t+e.totalHours,0)),y=l(()=>d.value.filter(t=>t.totalHours>0).length);l(()=>{const t=y.value;return t>0?p.value/t:0});const x=l(()=>{const t=y.value*8;return Math.max(0,p.value-t)}),h=t=>{if(!t||t===0)return"00:00:00";const e=Math.floor(t),s=Math.floor((t-e)*60),n=Math.round(((t-e)*60-s)*60);return`${e.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}`},u=t=>{const e=new Date(t),s=e.getDay(),n=e.getDate()-s+(s===0?-6:1);return new Date(e.setDate(n))},f=t=>{const e=u(t),s=new Date(e);return s.setDate(e.getDate()+6),s},D=t=>{const e=new Date(t.getFullYear(),0,1),s=Math.floor((t-e)/(24*60*60*1e3));return Math.ceil((s+e.getDay()+1)/7)},v=t=>t.toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"}),b=()=>{const t=u(i.value),e=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];d.value=[];for(let s=0;s<7;s++){const n=new Date(t);n.setDate(t.getDate()+s),d.value.push({dayNumber:s+1,dayName:e[s],date:n,startTime:"",endTime:"",totalHours:0,comment:"",status:"pending"})}},S=async()=>{try{const t=JSON.parse(localStorage.getItem("currentUser")||"{}"),e=u(i.value).toISOString().split("T")[0],s=f(i.value).toISOString().split("T")[0],k=(await _.list(t.id,e,s)).data||[];d.value.forEach(c=>{const a=k.find(r=>new Date(r.start||r.start_time||r.startTime).toDateString()===c.date.toDateString());if(a){const r=a.start||a.start_time||a.startTime,m=a.end||a.end_time||a.endTime;if(r&&(c.startTime=new Date(r).toTimeString().slice(0,5)),m&&(c.endTime=new Date(m).toTimeString().slice(0,5)),r&&m){const T=new Date(r),M=new Date(m)-T;c.totalHours=Math.max(0,M/(1e3*60*60))}c.status="completed"}})}catch(t){console.error("Error loading weekly data:",t)}};return H(()=>{b(),S()}),(t,e)=>(W(),$("section",B,[o("div",E,[o("div",O,[o("div",V,[e[2]||(e[2]=o("div",null,[o("h1",{class:"text-3xl font-bold text-gray-900 mb-2"},"Working Times"),o("p",{class:"text-gray-600"},"View your overtime hours and manage your work schedule")],-1)),o("button",{onClick:e[0]||(e[0]=s=>t.$router.push("/user-schedule")),class:"px-4 py-2 text-sm font-medium text-indigo-600 bg-indigo-50 rounded-lg hover:bg-indigo-100"}," 📅 Set My Schedule ")])]),o("div",C,[o("div",I,[e[3]||(e[3]=o("h2",{class:"text-lg font-semibold text-gray-900"},"Overtime Hours",-1)),o("div",j,N(h(x.value)),1)])]),o("div",F,[o("div",G,[e[6]||(e[6]=o("span",{class:"text-2xl mr-3"},"ℹ️",-1)),o("div",null,[e[4]||(e[4]=o("h4",{class:"font-medium text-blue-900 mb-1"},"How to Update Your Schedule",-1)),e[5]||(e[5]=o("p",{class:"text-sm text-blue-700"},[w(" This page shows your actual worked hours from clock-in/out records. To set your weekly schedule (preferred working hours), go to "),o("strong",null,'"My Schedule"'),w(" page. ")],-1)),o("button",{onClick:e[1]||(e[1]=s=>t.$router.push("/user-schedule")),class:"mt-3 px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700"}," Go to My Schedule → ")])])])])]))}};export{L as default};
