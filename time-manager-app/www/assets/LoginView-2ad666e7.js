import{o as d,c as u,a as e,F as k,r as C,t as m,n as U,b as x,w as E,v as M,d as _,e as L,u as B,f as v,g as z,h as F,i as S,j,k as A}from"./index-c228e4e8.js";import{_ as V}from"./_plugin-vue_export-helper-c27b6911.js";const N={name:"LoginPage",props:{users:{type:Array,default:()=>[]},usersLoading:{type:Boolean,default:!1},usersError:{type:String,default:""},loginError:{type:String,default:""}},data(){return{selectedUser:null,signinForm:{password:""}}},methods:{initials(a){return a?(a.first_name||a.username||a.email||"").split(" ").map(i=>i?i[0].toUpperCase():"").slice(0,2).join(""):"??"},displayName(a){return a?a.first_name||a.username||a.email||"User":"Unknown User"},selectUser(a){this.selectedUser=a,this.signinForm.password="",this.$nextTick(()=>{const t=document.getElementById("signin_password");t&&t.focus()})},handleSignin(){!this.selectedUser||!this.signinForm.password||this.$emit("signin",{email:this.selectedUser.email,password:this.signinForm.password})}},watch:{selectedUser(){this.signinForm.password=""},users(){this.selectedUser=null}}},P={class:"space-y-6"},T={key:0},H={key:0,class:"space-y-4"},I={key:1,class:"rounded-md bg-red-50 p-4 mb-4"},D={class:"flex"},R={class:"ml-3"},W={class:"text-sm font-medium text-red-800"},q={key:2,class:"space-y-3"},G=["onClick"],J={class:"flex-shrink-0 h-10 w-10 rounded-full bg-indigo-100 flex items-center justify-center text-indigo-600 font-medium"},O={class:"ml-4 text-left flex-1 min-w-0"},$={class:"flex items-center justify-between"},K={class:"text-sm font-medium text-gray-900 truncate"},Q={class:"text-sm text-gray-500 truncate"},X={key:3,class:"text-center py-8"},Y={class:"mt-6"},Z={key:1},ee={class:"flex items-center justify-between mb-6"},te={class:"flex items-center p-4 bg-indigo-50 rounded-lg mb-6"},se={class:"flex-shrink-0 h-12 w-12 rounded-full bg-indigo-100 flex items-center justify-center text-indigo-600 font-medium text-lg"},re={class:"ml-4"},oe={class:"text-sm font-medium text-gray-900"},ne={class:"text-sm text-gray-500"},ie={class:"mt-1 relative rounded-md shadow-sm"},le={key:0,class:"mt-1 text-sm text-red-600"},ae=["disabled"];function de(a,t,i,y,l,c){return d(),u("div",P,[l.selectedUser?(d(),u("div",Z,[e("div",ee,[t[11]||(t[11]=e("h2",{class:"text-2xl font-bold text-gray-900"},"Welcome back",-1)),e("button",{type:"button",onClick:t[1]||(t[1]=s=>l.selectedUser=null),class:"text-sm font-medium text-indigo-600 hover:text-indigo-500 focus:outline-none"}," Change user ")]),e("div",te,[e("div",se,m(c.initials(l.selectedUser)),1),e("div",re,[e("p",oe,m(c.displayName(l.selectedUser)),1),e("p",ne,m(l.selectedUser.email),1)])]),e("form",{onSubmit:t[3]||(t[3]=L((...s)=>c.handleSignin&&c.handleSignin(...s),["prevent"])),class:"space-y-6"},[e("div",null,[t[13]||(t[13]=e("label",{for:"signin_password",class:"block text-sm font-medium text-gray-700 mb-1"}," Password ",-1)),e("div",ie,[E(e("input",{id:"signin_password","onUpdate:modelValue":t[2]||(t[2]=s=>l.signinForm.password=s),type:"password",required:"",class:"w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors duration-200",placeholder:"Enter your password"},null,512),[[M,l.signinForm.password]]),t[12]||(t[12]=e("div",{class:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none"},[e("svg",{class:"h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z","clip-rule":"evenodd"})])],-1))]),i.loginError?(d(),u("div",le,m(i.loginError),1)):_("",!0),t[14]||(t[14]=e("div",{class:"mt-2 text-right"},[e("a",{href:"#",class:"text-sm font-medium text-indigo-600 hover:text-indigo-500"}," Forgot password? ")],-1))]),e("div",null,[e("button",{type:"submit",class:U(["w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-gradient-to-r from-indigo-600 to-blue-700 hover:from-indigo-700 hover:to-blue-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors duration-200",{"opacity-75 cursor-not-allowed":!l.signinForm.password}]),disabled:!l.signinForm.password},[...t[15]||(t[15]=[e("svg",{class:"h-5 w-5 mr-2 -ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"})],-1),x(" Sign in ",-1)])],10,ae)])],32)])):(d(),u("div",T,[t[10]||(t[10]=e("div",{class:"text-center mb-6"},[e("h2",{class:"text-2xl font-bold text-gray-900"},"Select an account"),e("p",{class:"mt-1 text-sm text-gray-500"},"Choose an account to continue")],-1)),i.usersLoading?(d(),u("div",H,[(d(),u(k,null,C(3,s=>e("div",{key:`skeleton-${s}`,class:"animate-pulse"},[...t[4]||(t[4]=[e("div",{class:"h-16 bg-gray-100 rounded-lg"},null,-1)])])),64))])):i.usersError?(d(),u("div",I,[e("div",D,[t[5]||(t[5]=e("div",{class:"flex-shrink-0"},[e("svg",{class:"h-5 w-5 text-red-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])],-1)),e("div",R,[e("h3",W,m(i.usersError),1)])])])):i.users&&i.users.length?(d(),u("div",q,[(d(!0),u(k,null,C(i.users,(s,p)=>{var h,w;return d(),u("button",{key:p,onClick:b=>c.selectUser(s),class:"w-full flex items-center p-4 rounded-lg border border-gray-200 hover:border-indigo-300 hover:bg-indigo-50 transition-colors duration-200"},[e("div",J,m(c.initials(s)),1),e("div",O,[e("div",$,[e("p",K,m(c.displayName(s)),1),e("span",{class:U(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",{"bg-purple-100 text-purple-800":((h=s.role)==null?void 0:h.toLowerCase())==="admin","bg-blue-100 text-blue-800":((w=s.role)==null?void 0:w.toLowerCase())==="user","bg-gray-100 text-gray-800":!s.role}])},m(s.role?s.role.toUpperCase():"USER"),3)]),e("p",Q,m(s.email),1)])],8,G)}),128))])):(d(),u("div",X,[t[7]||(t[7]=e("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})],-1)),t[8]||(t[8]=e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No users found",-1)),t[9]||(t[9]=e("p",{class:"mt-1 text-sm text-gray-500"},"Get started by creating a new account.",-1)),e("div",Y,[e("button",{type:"button",onClick:t[0]||(t[0]=s=>a.$emit("switch-page","signup")),class:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"},[...t[6]||(t[6]=[e("svg",{class:"-ml-1 mr-2 h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[e("path",{"fill-rule":"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z","clip-rule":"evenodd"})],-1),x(" New Account ",-1)])])])]))]))])}const ue=V(N,[["render",de],["__scopeId","data-v-be07c996"]]),ce={class:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4"},me={class:"w-full max-w-md"},ge={class:"text-center mb-8"},fe={key:0,class:"mt-4 p-4 bg-green-50 border border-green-200 rounded-lg"},ve={class:"flex"},xe={class:"ml-3"},pe={class:"text-sm font-medium text-green-800"},he={key:0,class:"text-sm text-green-700 mt-1"},we={class:"bg-white rounded-xl shadow-md overflow-hidden"},ye={class:"p-8"},be={class:"mt-6 text-center"},_e={class:"text-sm text-gray-600"},Se={__name:"LoginView",setup(a){const t=B(),i=v(!1),y=v(""),l=v(""),c=v(!1),s=v(null),p=v([]);z(async()=>{i.value=!0;try{const n=await F.list();p.value=Array.isArray(n)?n:Array.isArray(n==null?void 0:n.data)?n.data:[]}catch{y.value="Failed to load users"}finally{i.value=!1}});const h=async({email:n,password:o})=>{if(l.value="",c.value=!1,!n||!o){l.value="Please enter both email and password";return}try{if(!await w(n,o)){l.value="Invalid email or password";return}const r=p.value.find(f=>f.email===n);if(r){const f={id:r.id,email:r.email,username:r.username,first_name:r.first_name,last_name:r.last_name,role:r.role};localStorage.setItem("currentUser",JSON.stringify(f)),s.value=f}c.value=!0,setTimeout(()=>t.push("/dashboard"),1500)}catch(g){console.error("Login error:",g),l.value=g.message||"An error occurred during login. Please try again."}},w=async(n,o)=>{var g;try{const r=await A.post("/api/sessions",{email:n,password:o});return(g=r==null?void 0:r.data)!=null&&g.token?(localStorage.setItem("authToken",r.data.token),!0):!1}catch(r){throw console.error("Authentication error:",r),r}},b=n=>{n==="signup"&&t.push("/signup")};return(n,o)=>{var g,r,f;return d(),u("div",ce,[e("div",me,[e("div",ge,[o[3]||(o[3]=S('<div class="mx-auto w-16 h-16 bg-indigo-600 rounded-2xl flex items-center justify-center mb-4"><svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></div><h1 class="text-3xl font-bold text-gray-900 mb-2">Time Manager</h1><p class="text-gray-600">Sign in to access your dashboard</p>',3)),c.value?(d(),u("div",fe,[e("div",ve,[o[2]||(o[2]=e("div",{class:"flex-shrink-0"},[e("svg",{class:"h-5 w-5 text-green-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})])],-1)),e("div",xe,[e("p",pe," Welcome back, "+m(((g=s.value)==null?void 0:g.first_name)||((r=s.value)==null?void 0:r.username)||"User")+"! ",1),(f=s.value)!=null&&f.role?(d(),u("p",he," Role: "+m(s.value.role.toUpperCase()),1)):_("",!0),o[1]||(o[1]=S('<p class="text-sm text-green-700 mt-2"><span class="inline-flex items-center"><svg class="animate-spin -ml-1 mr-2 h-4 w-4 text-green-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Redirecting... </span></p>',1))])])])):_("",!0)]),e("div",we,[e("div",ye,[j(ue,{users:p.value,usersLoading:i.value,usersError:y.value,loginError:l.value,onSignin:h,onSwitchPage:b},null,8,["users","usersLoading","usersError","loginError"])]),o[4]||(o[4]=e("div",{class:"bg-gray-50 px-6 py-4 border-t border-gray-200"},[e("p",{class:"text-xs text-center text-gray-500"},[x(" By signing in, you agree to our "),e("a",{href:"#",class:"text-indigo-600 hover:text-indigo-500 font-medium"},"Terms"),x(" and "),e("a",{href:"#",class:"text-indigo-600 hover:text-indigo-500 font-medium"},"Privacy Policy"),x(". ")])],-1))]),e("div",be,[e("p",_e,[o[5]||(o[5]=x(" Don't have an account? ",-1)),e("a",{href:"#",onClick:o[0]||(o[0]=L(ke=>b("signup"),["prevent"])),class:"font-medium text-indigo-600 hover:text-indigo-500"}," Sign up for free ")])])])])}}};export{Se as default};
