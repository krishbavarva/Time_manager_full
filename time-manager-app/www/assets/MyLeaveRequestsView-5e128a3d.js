import{x as z,r as c,f as k,D as A,o as i,c as u,a as e,t as l,j as W,w as y,k as j,d as O,v as M,y as m,C as U,b as p,m as q,g as X,e as Y,F as Z,i as ee,q as te,n as N}from"./index-621cd5fc.js";import{l as T,g as P,a as B,b as H,c as I}from"./leaveRequests-38ddcdf8.js";import"./http-f1abb376.js";const se={class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},ae={class:"relative top-10 mx-auto p-5 border w-full max-w-2xl shadow-lg rounded-md bg-white"},le={class:"mt-3"},oe={class:"flex items-center justify-between mb-6"},de={class:"text-xl font-medium text-gray-900"},ne={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},re=["min"],ie=["min"],ue={class:"space-y-2"},ve={class:"flex items-center"},ce={class:"flex items-center"},pe={class:"flex items-center"},me={key:0,class:"bg-blue-50 border border-blue-200 rounded-lg p-3"},ye={class:"flex items-center"},xe={class:"text-sm font-medium text-blue-800"},ge={class:"text-xs text-gray-500 mt-1"},be={class:"flex justify-end space-x-3 pt-4 border-t"},_e=["disabled"],fe={__name:"LeaveRequestForm",props:{editingRequest:{type:Object,default:null},showModal:{type:Boolean,default:!1}},emits:["close","success"],setup(S,{emit:x}){const g=S,f=x,s=c({leave_type:"",start_date:"",end_date:"",duration_type:"full_day",reason:""}),b=c(!1),n=new Date().toISOString().split("T")[0],w=k(()=>{if(!s.value.start_date||!s.value.end_date)return 0;const v=new Date(s.value.start_date),r=new Date(s.value.end_date)-v,V=Math.ceil(r/(1e3*60*60*24))+1;return s.value.duration_type==="full_day"?V:V*.5}),h=k(()=>s.value.leave_type&&s.value.start_date&&s.value.end_date&&s.value.reason&&s.value.reason.length>=10&&s.value.reason.length<=500),D=()=>{s.value.start_date&&!s.value.end_date&&(s.value.end_date=s.value.start_date)},_=()=>{s.value.start_date===s.value.end_date&&s.value.duration_type},$=async()=>{if(h.value){b.value=!0;try{g.editingRequest?(await T.update(g.editingRequest.id,s.value),q.success("Leave request updated successfully!")):(await T.create(s.value),q.success("Leave request submitted successfully!")),f("success"),R()}catch(v){console.error("Error submitting leave request:",v),q.error("Failed to submit leave request. Please try again.")}finally{b.value=!1}}},R=()=>{f("close")},C=()=>{s.value={leave_type:"",start_date:"",end_date:"",duration_type:"full_day",reason:""}};return A(()=>g.editingRequest,v=>{v?s.value={leave_type:v.leave_type,start_date:v.start_date,end_date:v.end_date,duration_type:v.duration_type,reason:v.reason}:C()},{immediate:!0}),A(()=>g.showModal,v=>{v||C()}),(v,a)=>(i(),u("div",se,[e("div",ae,[e("div",le,[e("div",oe,[e("h3",de,l(S.editingRequest?"Edit Leave Request":"Submit Leave Request"),1),e("button",{onClick:R,class:"text-gray-400 hover:text-gray-600 text-2xl"}," ✕ ")]),e("form",{onSubmit:W($,["prevent"]),class:"space-y-6"},[e("div",null,[a[8]||(a[8]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Leave Type *",-1)),y(e("select",{"onUpdate:modelValue":a[0]||(a[0]=r=>s.value.leave_type=r),required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"},[...a[7]||(a[7]=[O('<option value="" data-v-3306caa8>Select Leave Type</option><option value="sick" data-v-3306caa8>Sick Leave</option><option value="vacation" data-v-3306caa8>Vacation</option><option value="personal" data-v-3306caa8>Personal Leave</option><option value="emergency" data-v-3306caa8>Emergency Leave</option><option value="holiday" data-v-3306caa8>Holiday</option>',6)])],512),[[j,s.value.leave_type]])]),e("div",ne,[e("div",null,[a[9]||(a[9]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Start Date *",-1)),y(e("input",{"onUpdate:modelValue":a[1]||(a[1]=r=>s.value.start_date=r),type:"date",required:"",min:m(n),onChange:D,class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"},null,40,re),[[M,s.value.start_date]])]),e("div",null,[a[10]||(a[10]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"End Date *",-1)),y(e("input",{"onUpdate:modelValue":a[2]||(a[2]=r=>s.value.end_date=r),type:"date",required:"",min:s.value.start_date||m(n),onChange:_,class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"},null,40,ie),[[M,s.value.end_date]])])]),e("div",null,[a[14]||(a[14]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Duration *",-1)),e("div",ue,[e("label",ve,[y(e("input",{"onUpdate:modelValue":a[3]||(a[3]=r=>s.value.duration_type=r),type:"radio",value:"full_day",class:"mr-2"},null,512),[[U,s.value.duration_type]]),a[11]||(a[11]=e("span",null,"Full Day",-1))]),e("label",ce,[y(e("input",{"onUpdate:modelValue":a[4]||(a[4]=r=>s.value.duration_type=r),type:"radio",value:"half_day_morning",class:"mr-2"},null,512),[[U,s.value.duration_type]]),a[12]||(a[12]=e("span",null,"Half Day (Morning)",-1))]),e("label",pe,[y(e("input",{"onUpdate:modelValue":a[5]||(a[5]=r=>s.value.duration_type=r),type:"radio",value:"half_day_afternoon",class:"mr-2"},null,512),[[U,s.value.duration_type]]),a[13]||(a[13]=e("span",null,"Half Day (Afternoon)",-1))])])]),w.value>0?(i(),u("div",me,[e("div",ye,[e("span",xe," Total Leave Days: "+l(w.value),1)])])):p("",!0),e("div",null,[a[15]||(a[15]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Reason *",-1)),y(e("textarea",{"onUpdate:modelValue":a[6]||(a[6]=r=>s.value.reason=r),required:"",rows:"4",placeholder:"Please provide a detailed reason for your leave request (minimum 10 characters)",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"},null,512),[[M,s.value.reason]]),e("p",ge,l(s.value.reason.length)+"/500 characters ",1)]),e("div",be,[e("button",{type:"button",onClick:R,class:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50"}," Cancel "),e("button",{type:"submit",disabled:b.value||!h.value,class:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed"},l(b.value?"Submitting...":S.editingRequest?"Update Request":"Submit Request"),9,_e)])],32)])])]))}},we=z(fe,[["__scopeId","data-v-3306caa8"]]);const he={class:"min-h-screen bg-gray-50 py-8 px-4 sm:px-6 lg:px-8"},ke={class:"max-w-7xl mx-auto"},De={class:"mb-8"},Re={class:"flex items-center justify-between"},Le={class:"text-gray-600"},qe={key:0,class:"font-medium"},Se={key:1},$e={class:"flex items-center space-x-4"},Ce={class:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6"},Ve={class:"bg-white rounded-xl shadow-sm border border-gray-200 p-6"},Fe={class:"flex items-center"},Me={class:"ml-4"},Te={class:"text-2xl font-bold text-gray-900"},Ue={class:"bg-white rounded-xl shadow-sm border border-gray-200 p-6"},je={class:"flex items-center"},Ee={class:"ml-4"},Ae={class:"text-2xl font-bold text-gray-900"},Ne={class:"bg-white rounded-xl shadow-sm border border-gray-200 p-6"},Pe={class:"flex items-center"},Be={class:"ml-4"},He={class:"text-2xl font-bold text-gray-900"},Ie={class:"bg-white rounded-xl shadow-sm border border-gray-200 p-6"},ze={class:"flex items-center"},Oe={class:"ml-4"},Je={class:"text-2xl font-bold text-gray-900"},Ge={class:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6"},Ke={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Qe={class:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden"},We={key:0,class:"p-8 text-center text-gray-500"},Xe={key:1,class:"p-8 text-center text-red-600"},Ye={key:2,class:"p-8 text-center text-gray-500"},Ze={key:3,class:"overflow-x-auto"},et={class:"min-w-full divide-y divide-gray-200"},tt={class:"bg-white divide-y divide-gray-200"},st={class:"px-6 py-4 whitespace-nowrap"},at={class:"text-sm font-medium text-gray-900"},lt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},ot={key:0,class:"text-xs text-gray-500"},dt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},nt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},rt={class:"px-6 py-4 whitespace-nowrap"},it={class:"px-6 py-4 text-sm text-gray-900 max-w-xs"},ut=["title"],vt={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},ct={class:"flex items-center space-x-2"},pt=["onClick"],mt=["onClick"],yt=["onClick"],xt={key:1,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},gt={class:"relative top-10 mx-auto p-5 border w-full max-w-2xl shadow-lg rounded-md bg-white"},bt={class:"mt-3"},_t={class:"flex items-center justify-between mb-6"},ft={class:"space-y-4"},wt={class:"grid grid-cols-2 gap-4"},ht={class:"text-sm text-gray-900"},kt={class:"grid grid-cols-2 gap-4"},Dt={class:"text-sm text-gray-900"},Rt={class:"text-sm text-gray-900"},Lt={class:"grid grid-cols-2 gap-4"},qt={class:"text-sm text-gray-900"},St={class:"text-sm text-gray-900"},$t={class:"text-sm text-gray-900"},Ct={key:0},Vt={class:"text-sm text-gray-900"},Ft={key:1},Mt={class:"block text-sm font-medium text-gray-700"},Tt={class:"text-sm text-gray-900"},Ut={__name:"MyLeaveRequestsView",setup(S){const x=c([]),g=c(!1),f=c(""),s=c(!1),b=c(null),n=c(null),w=c(""),h=c(""),D=c(""),_=c(JSON.parse(localStorage.getItem("currentUser")||"{}")),$=k(()=>{let o=x.value;if(w.value&&(o=o.filter(t=>t.status===w.value)),h.value&&(o=o.filter(t=>t.leave_type===h.value)),D.value){const t=new Date(D.value);o=o.filter(d=>{const L=new Date(d.start_date),E=new Date(d.end_date);return L<=t&&t<=E||L.toDateString()===t.toDateString()||E.toDateString()===t.toDateString()})}return o}),R=k(()=>x.value.filter(o=>o.status==="pending").length),C=k(()=>x.value.filter(o=>o.status==="approved").length),v=k(()=>x.value.filter(o=>o.status==="rejected").length),a=k(()=>x.value.reduce((o,t)=>o+parseFloat(t.total_days||0),0)),r=async()=>{if(_.value.id){g.value=!0,f.value="";try{const o=await T.listByUser(_.value.id);x.value=o.data||[]}catch(o){console.error("Error loading leave requests:",o),f.value="Failed to load leave requests"}finally{g.value=!1}}},V=o=>{n.value=o},J=o=>{b.value=o,s.value=!0},G=async o=>{if(confirm("Are you sure you want to delete this leave request?"))try{await T.remove(o.id),await r(),q.success("Leave request deleted successfully!")}catch(t){console.error("Error deleting leave request:",t),q.error("Failed to delete leave request")}},K=()=>{s.value=!1,b.value=null},Q=()=>{r()},F=o=>o?new Date(o).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"";return X(()=>{r()}),(o,t)=>(i(),u("div",he,[e("div",ke,[e("div",De,[e("div",Re,[e("div",null,[t[6]||(t[6]=e("h1",{class:"text-3xl font-bold text-gray-900 mb-2"},"My Leave Requests",-1)),e("p",Le,[_.value.first_name?(i(),u("span",qe,l(_.value.first_name)+" "+l(_.value.last_name),1)):p("",!0),_.value.first_name?(i(),u("span",Se," - ")):p("",!0),t[5]||(t[5]=Y(" Manage your leave requests and track their status ",-1))])]),e("div",$e,[e("button",{onClick:t[0]||(t[0]=d=>s.value=!0),class:"px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700"}," ➕ Submit Leave Request ")])])]),e("div",Ce,[e("div",Ve,[e("div",Fe,[t[8]||(t[8]=e("div",{class:"p-3 bg-yellow-100 rounded-lg"},[e("span",{class:"text-2xl"},"⏳")],-1)),e("div",Me,[t[7]||(t[7]=e("p",{class:"text-sm font-medium text-gray-500"},"Pending",-1)),e("p",Te,l(R.value),1)])])]),e("div",Ue,[e("div",je,[t[10]||(t[10]=e("div",{class:"p-3 bg-green-100 rounded-lg"},[e("span",{class:"text-2xl"},"✅")],-1)),e("div",Ee,[t[9]||(t[9]=e("p",{class:"text-sm font-medium text-gray-500"},"Approved",-1)),e("p",Ae,l(C.value),1)])])]),e("div",Ne,[e("div",Pe,[t[12]||(t[12]=e("div",{class:"p-3 bg-red-100 rounded-lg"},[e("span",{class:"text-2xl"},"❌")],-1)),e("div",Be,[t[11]||(t[11]=e("p",{class:"text-sm font-medium text-gray-500"},"Rejected",-1)),e("p",He,l(v.value),1)])])]),e("div",Ie,[e("div",ze,[t[14]||(t[14]=e("div",{class:"p-3 bg-blue-100 rounded-lg"},[e("span",{class:"text-2xl"},"📅")],-1)),e("div",Oe,[t[13]||(t[13]=e("p",{class:"text-sm font-medium text-gray-500"},"Total Days",-1)),e("p",Je,l(a.value.toFixed(1)),1)])])])]),e("div",Ge,[e("div",Ke,[e("div",null,[t[16]||(t[16]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Status",-1)),y(e("select",{"onUpdate:modelValue":t[1]||(t[1]=d=>w.value=d),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"},[...t[15]||(t[15]=[e("option",{value:""},"All Status",-1),e("option",{value:"pending"},"Pending",-1),e("option",{value:"approved"},"Approved",-1),e("option",{value:"rejected"},"Rejected",-1)])],512),[[j,w.value]])]),e("div",null,[t[18]||(t[18]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Leave Type",-1)),y(e("select",{"onUpdate:modelValue":t[2]||(t[2]=d=>h.value=d),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"},[...t[17]||(t[17]=[O('<option value="" data-v-7b63f80c>All Types</option><option value="sick" data-v-7b63f80c>Sick Leave</option><option value="vacation" data-v-7b63f80c>Vacation</option><option value="personal" data-v-7b63f80c>Personal Leave</option><option value="emergency" data-v-7b63f80c>Emergency Leave</option><option value="holiday" data-v-7b63f80c>Holiday</option>',6)])],512),[[j,h.value]])]),e("div",null,[t[19]||(t[19]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Date Range",-1)),y(e("input",{"onUpdate:modelValue":t[3]||(t[3]=d=>D.value=d),type:"date",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"},null,512),[[M,D.value]])])])]),e("div",Qe,[t[21]||(t[21]=e("div",{class:"px-6 py-4 border-b border-gray-200"},[e("h2",{class:"text-lg font-semibold text-gray-900"},"Leave Requests")],-1)),g.value?(i(),u("div",We," Loading leave requests... ")):f.value?(i(),u("div",Xe,l(f.value),1)):$.value.length===0?(i(),u("div",Ye," No leave requests found. ")):(i(),u("div",Ze,[e("table",et,[t[20]||(t[20]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Leave Type"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Date Range"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Duration"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Total Days"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Reason"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),e("tbody",tt,[(i(!0),u(Z,null,ee($.value,d=>(i(),u("tr",{key:d.id,class:"hover:bg-gray-50"},[e("td",st,[e("span",at,l(m(P)(d.leave_type)),1)]),e("td",lt,[e("div",null,[e("div",null,l(F(d.start_date)),1),d.start_date!==d.end_date?(i(),u("div",ot," to "+l(F(d.end_date)),1)):p("",!0)])]),e("td",dt,l(m(B)(d.duration_type)),1),e("td",nt,l(d.total_days)+" day"+l(d.total_days!==1?"s":""),1),e("td",rt,[e("span",{class:N(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",m(H)(d.status)])},l(m(I)(d.status)),3)]),e("td",it,[e("div",{class:"truncate",title:d.reason},l(d.reason),9,ut)]),e("td",vt,[e("div",ct,[e("button",{onClick:L=>V(d),class:"text-blue-600 hover:text-blue-800",title:"View Details"}," 👁️ ",8,pt),d.status==="pending"?(i(),u("button",{key:0,onClick:L=>J(d),class:"text-indigo-600 hover:text-indigo-800",title:"Edit"}," ✏️ ",8,mt)):p("",!0),d.status==="pending"?(i(),u("button",{key:1,onClick:L=>G(d),class:"text-red-600 hover:text-red-800",title:"Delete"}," 🗑️ ",8,yt)):p("",!0)])])]))),128))])])]))])]),s.value?(i(),te(we,{key:0,"editing-request":b.value,"show-modal":s.value,onClose:K,onSuccess:Q},null,8,["editing-request","show-modal"])):p("",!0),n.value?(i(),u("div",xt,[e("div",gt,[e("div",bt,[e("div",_t,[t[22]||(t[22]=e("h3",{class:"text-xl font-medium text-gray-900"},"Leave Request Details",-1)),e("button",{onClick:t[4]||(t[4]=d=>n.value=null),class:"text-gray-400 hover:text-gray-600 text-2xl"}," ✕ ")]),e("div",ft,[e("div",wt,[e("div",null,[t[23]||(t[23]=e("label",{class:"block text-sm font-medium text-gray-700"},"Leave Type",-1)),e("p",ht,l(m(P)(n.value.leave_type)),1)]),e("div",null,[t[24]||(t[24]=e("label",{class:"block text-sm font-medium text-gray-700"},"Status",-1)),e("span",{class:N(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",m(H)(n.value.status)])},l(m(I)(n.value.status)),3)])]),e("div",kt,[e("div",null,[t[25]||(t[25]=e("label",{class:"block text-sm font-medium text-gray-700"},"Start Date",-1)),e("p",Dt,l(F(n.value.start_date)),1)]),e("div",null,[t[26]||(t[26]=e("label",{class:"block text-sm font-medium text-gray-700"},"End Date",-1)),e("p",Rt,l(F(n.value.end_date)),1)])]),e("div",Lt,[e("div",null,[t[27]||(t[27]=e("label",{class:"block text-sm font-medium text-gray-700"},"Duration",-1)),e("p",qt,l(m(B)(n.value.duration_type)),1)]),e("div",null,[t[28]||(t[28]=e("label",{class:"block text-sm font-medium text-gray-700"},"Total Days",-1)),e("p",St,l(n.value.total_days)+" day"+l(n.value.total_days!==1?"s":""),1)])]),e("div",null,[t[29]||(t[29]=e("label",{class:"block text-sm font-medium text-gray-700"},"Reason",-1)),e("p",$t,l(n.value.reason),1)]),n.value.admin_notes?(i(),u("div",Ct,[t[30]||(t[30]=e("label",{class:"block text-sm font-medium text-gray-700"},"Admin Notes",-1)),e("p",Vt,l(n.value.admin_notes),1)])):p("",!0),n.value.approved_by?(i(),u("div",Ft,[e("label",Mt,l(n.value.status==="approved"?"Approved by":"Processed by"),1),e("p",Tt,l(n.value.approved_by.first_name)+" "+l(n.value.approved_by.last_name),1)])):p("",!0)])])])])):p("",!0)]))}},Nt=z(Ut,[["__scopeId","data-v-7b63f80c"]]);export{Nt as default};
