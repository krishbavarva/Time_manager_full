import{r as m,g as S,o as i,c as u,a as s,F as U,i as V,t as x,w as c,l as E,v as h}from"./index-5e39243b.js";import{userSchedulesApi as _}from"./userSchedules-3305ba19.js";import"./http-8cebfae0.js";const C={class:"min-h-screen bg-gray-50 py-8 px-4 sm:px-6 lg:px-8"},M={class:"max-w-4xl mx-auto"},A={class:"mb-8"},F={class:"flex items-center justify-between"},D={class:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6"},B={class:"space-y-4"},P={class:"w-24"},I={class:"text-sm font-medium text-gray-700 capitalize"},N={class:"flex items-center space-x-2"},T=["onUpdate:modelValue"],W={key:0,class:"flex items-center space-x-2"},j=["onUpdate:modelValue"],z=["onUpdate:modelValue"],O=["onUpdate:modelValue"],$={key:1,class:"text-sm text-gray-500"},H={class:"mt-6 flex justify-end space-x-3"},J=["disabled"],G={__name:"UserScheduleView",setup(L){const o=m([]),n=m(!1),a=m(null),f=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"];S(()=>{const e=JSON.parse(localStorage.getItem("currentUser")||"{}");e&&e.id?(a.value=e.id,b(),p()):console.error("User not found in localStorage")});const b=()=>{o.value=f.map(e=>({day_of_week:e,scheduled_start_time:"09:00",scheduled_end_time:"17:00",scheduled_hours:8,is_active:e!=="saturday"&&e!=="sunday"}))},p=async()=>{if(a.value)try{const t=(await _.list(a.value)).data||[];o.value.forEach(d=>{const r=t.find(l=>l.day_of_week===d.day_of_week);r&&(d.scheduled_start_time=r.scheduled_start_time||"09:00",d.scheduled_end_time=r.scheduled_end_time||"17:00",d.scheduled_hours=r.scheduled_hours||8,d.is_active=r.is_active!==!1,d.id=r.id)})}catch(e){console.error("Error loading existing schedules:",e)}},g=async()=>{if(!a.value){alert("User ID not found. Please log in again.");return}n.value=!0;try{for(const e of o.value)if(e.is_active){const t={user_id:a.value,day_of_week:e.day_of_week,scheduled_start_time:e.scheduled_start_time,scheduled_end_time:e.scheduled_end_time,scheduled_hours:parseFloat(e.scheduled_hours),is_active:!0};e.id?await _.update(e.id,t):await _.create(t)}else e.id&&await _.update(e.id,{is_active:!1});alert("Schedule saved successfully!")}catch(e){console.error("Error saving schedule:",e),alert("Failed to save schedule. Please try again.")}finally{n.value=!1}},v=()=>{b()},y=()=>{o.value.forEach(e=>{e.day_of_week!=="saturday"&&e.day_of_week!=="sunday"?(e.scheduled_start_time="09:00",e.scheduled_end_time="17:00",e.scheduled_hours=8,e.is_active=!0):e.is_active=!1})},w=()=>{o.value.forEach(e=>{e.day_of_week!=="saturday"&&e.day_of_week!=="sunday"?(e.scheduled_start_time="08:00",e.scheduled_end_time="18:00",e.scheduled_hours=10,e.is_active=!0):e.is_active=!1})},k=()=>{confirm("Are you sure you want to clear all schedules?")&&o.value.forEach(e=>{e.is_active=!1})};return(e,t)=>(i(),u("section",C,[s("div",M,[s("div",A,[s("div",F,[t[1]||(t[1]=s("div",null,[s("h1",{class:"text-3xl font-bold text-gray-900 mb-2"},"My Schedule"),s("p",{class:"text-gray-600"},"Set your weekly working schedule")],-1)),s("button",{onClick:t[0]||(t[0]=d=>e.$router.push("/dashboard")),class:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50"}," Back to Dashboard ")])]),s("div",D,[t[6]||(t[6]=s("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Weekly Schedule",-1)),s("div",B,[(i(!0),u(U,null,V(o.value,(d,r)=>(i(),u("div",{key:d.day_of_week,class:"flex items-center space-x-4 p-4 border border-gray-200 rounded-lg"},[s("div",P,[s("label",I,x(d.day_of_week),1)]),s("div",N,[c(s("input",{type:"checkbox","onUpdate:modelValue":l=>d.is_active=l,class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"},null,8,T),[[E,d.is_active]]),t[2]||(t[2]=s("span",{class:"text-sm text-gray-600"},"Working day",-1))]),d.is_active?(i(),u("div",W,[s("div",null,[t[3]||(t[3]=s("label",{class:"block text-xs text-gray-500 mb-1"},"Start Time",-1)),c(s("input",{type:"time","onUpdate:modelValue":l=>d.scheduled_start_time=l,class:"w-32 px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"},null,8,j),[[h,d.scheduled_start_time]])]),s("div",null,[t[4]||(t[4]=s("label",{class:"block text-xs text-gray-500 mb-1"},"End Time",-1)),c(s("input",{type:"time","onUpdate:modelValue":l=>d.scheduled_end_time=l,class:"w-32 px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"},null,8,z),[[h,d.scheduled_end_time]])]),s("div",null,[t[5]||(t[5]=s("label",{class:"block text-xs text-gray-500 mb-1"},"Hours",-1)),c(s("input",{type:"number","onUpdate:modelValue":l=>d.scheduled_hours=l,step:"0.5",min:"0",max:"24",class:"w-20 px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"},null,8,O),[[h,d.scheduled_hours]])])])):(i(),u("div",$," Non-working day "))]))),128))]),s("div",H,[s("button",{onClick:v,class:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50"}," Reset "),s("button",{onClick:g,disabled:n.value,class:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:opacity-50"},x(n.value?"Saving...":"Save Schedule"),9,J)])]),s("div",{class:"bg-white rounded-xl shadow-sm border border-gray-200 p-6"},[t[7]||(t[7]=s("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Quick Actions",-1)),s("div",{class:"flex flex-wrap gap-3"},[s("button",{onClick:y,class:"px-4 py-2 bg-green-600 text-white text-sm font-medium rounded-md hover:bg-green-700"}," Set Standard Schedule (9 AM - 5 PM) "),s("button",{onClick:w,class:"px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700"}," Set Flexible Schedule (8 AM - 6 PM) "),s("button",{onClick:k,class:"px-4 py-2 bg-red-600 text-white text-sm font-medium rounded-md hover:bg-red-700"}," Clear All Schedules ")])])])]))}};export{G as default};
