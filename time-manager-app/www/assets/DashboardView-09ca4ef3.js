import{r as g,f as O,g as ne,h as le,o as d,c as p,d as L,a as e,t as m,b as $,F as ie,i as de,e as q,n as N,j as ee,w as G,k as we,v as _e,l as Se,m as j,u as Ce,p as te,q as se,s as Te}from"./index-621cd5fc.js";import{workingTimesApi as $e}from"./workingTimes-d509afa4.js";import{clockinsApi as V}from"./clockins-c9805d20.js";import{attendanceApi as oe}from"./attendance-a1dc7538.js";import{userSchedulesApi as Ae}from"./userSchedules-3c685781.js";import{u as re}from"./users-a5fc0dd3.js";import{_ as De}from"./LoadingSpinner-93693765.js";import{c as Me}from"./complaints-a2612d46.js";import{C as ae}from"./auto-69f04699.js";import"./http-f1abb376.js";const Re={exportToCSV(i,c="export.csv"){if(!i||i.length===0){console.warn("No data to export");return}const s=Object.keys(i[0]),B=[s.join(","),...i.map(I=>s.map(b=>{const r=I[b];return typeof r=="string"&&(r.includes(",")||r.includes('"'))?`"${r.replace(/"/g,'""')}"`:r}).join(","))].join(`
`),x=new Blob([B],{type:"text/csv;charset=utf-8;"}),_=document.createElement("a"),k=URL.createObjectURL(x);_.setAttribute("href",k),_.setAttribute("download",c),_.style.visibility="hidden",document.body.appendChild(_),_.click(),document.body.removeChild(_)},exportUsers(i){const c=i.map(s=>({"First Name":s.first_name||"","Last Name":s.last_name||"",Email:s.email||"",Username:s.username||"",Role:s.role||"",Team:s.team||"Unassigned",Status:s.status||"offline",Created:s.inserted_at?new Date(s.inserted_at).toLocaleDateString():""}));this.exportToCSV(c,`users-${new Date().toISOString().split("T")[0]}.csv`)},exportWorkingTimes(i){const c=i.map(s=>({Date:s.start?new Date(s.start).toLocaleDateString():"","Start Time":s.start?new Date(s.start).toLocaleTimeString():"","End Time":s.end?new Date(s.end).toLocaleTimeString():"","Total Hours":this.formatHours(s.total_hours||0),"Scheduled Hours":this.formatHours(s.scheduled_hours||0),"Break Hours":this.formatHours(s.break_hours||0),"Overtime Hours":this.formatHours(s.overtime_hours||0),Status:s.status||"pending"}));this.exportToCSV(c,`working-times-${new Date().toISOString().split("T")[0]}.csv`)},exportTeams(i){const c=i.map(s=>({"Team Name":s.name||"",Manager:s.manager_name||"Unassigned",Members:s.member_count||0,"Online Members":s.online_count||0,"Average Hours":s.average_hours||"0:00",Created:s.inserted_at?new Date(s.inserted_at).toLocaleDateString():""}));this.exportToCSV(c,`teams-${new Date().toISOString().split("T")[0]}.csv`)},exportAttendance(i){const c=i.map(s=>({Date:s.date||"",Employee:s.user_name||"",Status:s.status||"","Clock In":s.clock_in||"","Clock Out":s.clock_out||"","Total Hours":this.formatHours(s.total_hours||0),"Break Time":this.formatHours(s.break_time||0)}));this.exportToCSV(c,`attendance-${new Date().toISOString().split("T")[0]}.csv`)},exportComprehensiveReport(i){const c={"Report Generated":new Date().toLocaleString(),"Total Employees":i.totalEmployees||0,"Online Employees":i.onlineEmployees||0,"Total Teams":i.totalTeams||0,"Average Work Hours":this.formatHours(i.averageWorkHours||0),"Productivity Score":`${i.productivityScore||0}%`};this.exportToCSV([c],`comprehensive-report-${new Date().toISOString().split("T")[0]}.csv`)},formatHours(i){if(!i||i===0)return"0:00";const c=Math.floor(i),s=Math.round((i-c)*60);return`${c}:${s.toString().padStart(2,"0")}`},exportToPDF(i,c="export.pdf"){console.log("PDF export not yet implemented"),alert("PDF export functionality will be implemented soon!")}},Ue={class:"bg-white rounded-xl shadow-sm border border-gray-200 p-6"},je={key:0,class:"grid grid-cols-1 md:grid-cols-1 gap-4 mb-6"},Be={class:"text-center p-4 bg-blue-50 rounded-lg"},Ie={class:"text-2xl font-bold text-blue-600"},Ee={class:"space-y-3"},He={class:"space-y-2 max-h-48 overflow-y-auto"},Le={class:"flex-shrink-0"},Ve={class:"w-6 h-6 bg-gray-300 rounded-full flex items-center justify-center"},We={class:"text-xs font-medium text-gray-700"},Fe={class:"flex-1 min-w-0"},Oe={class:"text-sm text-gray-900"},Ne={class:"font-medium"},ze={class:"text-xs text-gray-500"},Pe={class:"flex-shrink-0"},Je={class:"mt-4 pt-4 border-t border-gray-200"},Ye={class:"flex items-center justify-between"},Ze={class:"flex items-center space-x-2"},Qe={__name:"RealTimeStatus",setup(i){const c=g(0),s=g(0),B=g(0),x=g(!0),_=g([]),k=g([]),I=O(()=>{try{return JSON.parse(localStorage.getItem("currentUser")||"{}").role||"employee"}catch{return"employee"}});let b=null;const r=async()=>{try{x.value=!0;const u=JSON.parse(localStorage.getItem("currentUser")||"{}"),n=u.role||"employee";let a=[];if(n==="admin")a=((await re.list()).data||[]).filter(H=>H.role!=="admin");else if(n==="manager")try{a=((await re.list()).data||[]).filter(H=>H.role!=="admin")}catch{u.role!=="admin"?a=[u]:a=[]}else a=[u];k.value=a;const f=k.value.map(C=>V.listByUser(C.id).catch(()=>({data:[]}))),w=await Promise.all(f);let v=0,S=0,R=0;k.value.forEach((C,W)=>{var z;const H=((z=w[W])==null?void 0:z.data)||[];if(H.length>0){const P=H[0],Y=new Date(P.time);(Date.now()-Y.getTime())/(1e3*60*60)<12?(P.status===!0&&S++,v++):R++}else R++}),c.value=v,s.value=S,B.value=R,await A()}catch(u){console.error("Error updating status:",u),x.value=!1;try{const n=JSON.parse(localStorage.getItem("currentUser")||"{}");if(n.id){k.value=[n];const f=(await V.listByUser(n.id)).data||[];if(f.length>0){const w=f[0];c.value=1,s.value=w.status?1:0,B.value=w.status?0:1}else c.value=0,s.value=0,B.value=1}}catch(n){console.error("Fallback error:",n)}}},A=async()=>{try{const u=[],n=k.value.slice(0,10).map(a=>a.id);for(const a of n)try{((await V.listByUser(a)).data||[]).slice(0,3).forEach(v=>{const S=k.value.find(R=>R.id===a);S&&u.push({id:`${a}-${v.id||v.time}`,user:{first_name:S.first_name,last_name:S.last_name},message:`${S.first_name} ${S.last_name} ${v.status?"clocked in":"clocked out"}`,type:v.status?"clock_in":"clock_out",timestamp:new Date(v.time)})})}catch(f){console.log(`Could not fetch clocks for user ${a}:`,f)}u.sort((a,f)=>f.timestamp-a.timestamp),_.value=u.slice(0,10)}catch(u){console.error("Error fetching recent activities:",u);try{const n=JSON.parse(localStorage.getItem("currentUser")||"{}");if(n.id){const w=((await V.listByUser(n.id)).data||[]).slice(0,5).map(v=>({id:`${n.id}-${v.id||v.time}`,user:{first_name:n.first_name,last_name:n.last_name},message:`${n.first_name} ${n.last_name} ${v.status?"clocked in":"clocked out"}`,type:v.status?"clock_in":"clock_out",timestamp:new Date(v.time)}));_.value=w}}catch(n){console.error("Fallback activities error:",n),_.value=[]}}},E=u=>{const a=new Date-u,f=Math.floor(a/6e4);if(f<1)return"Just now";if(f<60)return`${f}m ago`;const w=Math.floor(f/60);return w<24?`${w}h ago`:u.toLocaleDateString()};return ne(()=>{r(),b=setInterval(r,3e4)}),le(()=>{b&&clearInterval(b)}),(u,n)=>(d(),p("div",Ue,[n[3]||(n[3]=L('<div class="flex items-center justify-between mb-4"><h3 class="text-lg font-semibold text-gray-900">Real-Time Status</h3><div class="flex items-center space-x-2"><div class="w-2 h-2 bg-green-400 rounded-full animate-pulse"></div><span class="text-sm text-gray-500">Live</span></div></div>',1)),I.value!=="employee"?(d(),p("div",je,[e("div",Be,[e("div",Ie,m(s.value),1),n[0]||(n[0]=e("div",{class:"text-sm text-blue-600"},"Currently Working",-1))])])):$("",!0),e("div",Ee,[n[1]||(n[1]=e("h4",{class:"font-medium text-gray-900"},"Recent Activity",-1)),e("div",He,[(d(!0),p(ie,null,de(_.value,a=>{var f,w,v,S;return d(),p("div",{key:a.id,class:"flex items-center space-x-3 p-2 bg-gray-50 rounded-lg"},[e("div",Le,[e("div",Ve,[e("span",We,m((w=(f=a.user)==null?void 0:f.first_name)==null?void 0:w[0]),1)])]),e("div",Fe,[e("p",Oe,[e("span",Ne,m((v=a.user)==null?void 0:v.first_name)+" "+m((S=a.user)==null?void 0:S.last_name),1),q(" "+m(a.message),1)]),e("p",ze,m(E(a.timestamp)),1)]),e("div",Pe,[e("span",{class:N(["px-2 py-1 text-xs font-medium rounded-full",a.type==="clock_in"?"bg-green-100 text-green-800":a.type==="clock_out"?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"])},m(a.type==="clock_in"?"In":a.type==="clock_out"?"Out":"Activity"),3)])])}),128))])]),e("div",Je,[e("div",Ye,[n[2]||(n[2]=e("span",{class:"text-sm text-gray-500"},"Connection Status",-1)),e("div",Ze,[e("div",{class:N(["w-2 h-2 rounded-full",x.value?"bg-green-400":"bg-red-400"])},null,2),e("span",{class:N(["text-sm font-medium",x.value?"text-green-600":"text-red-600"])},m(x.value?"Connected":"Disconnected"),3)])])])]))}},Ge={class:"bg-white rounded-xl shadow-2xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto"},qe={class:"bg-gradient-to-r from-red-500 to-pink-500 p-6 rounded-t-xl"},Xe={class:"flex items-center justify-between"},Ke={class:"p-6"},et={class:"mb-6"},tt={class:"mb-6"},st={class:"text-xs text-gray-500 mt-1"},ot={class:"mb-6"},rt={class:"flex items-center"},at={class:"flex justify-end space-x-3"},nt=["disabled"],lt={__name:"ComplaintForm",emits:["close","submitted"],setup(i,{emit:c}){const s=c,B=g(""),x=g(""),_=g(!1),k=g(!1),I=async()=>{if(x.value.length<10){j.error("Please provide more details (at least 10 characters)");return}try{k.value=!0;const b=JSON.parse(localStorage.getItem("currentUser"));if(!(b!=null&&b.id)){j.error("User not found. Please login again.");return}const r=`[${B.value||"Other"}] ${x.value}`;await Me.create({user_id:b.id,complaint:r}),j.success("Complaint submitted successfully! We will review it soon."),s("submitted"),s("close")}catch(b){console.error("Error submitting complaint:",b),j.error("Failed to submit complaint. Please try again.")}finally{k.value=!1}};return(b,r)=>(d(),p("div",{class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:r[5]||(r[5]=ee(A=>b.$emit("close"),["self"]))},[e("div",Ge,[e("div",qe,[e("div",Xe,[r[6]||(r[6]=e("div",{class:"flex items-center"},[e("span",{class:"text-4xl mr-3"},"📝"),e("h2",{class:"text-2xl font-bold text-white"},"Submit a Complaint")],-1)),e("button",{onClick:r[0]||(r[0]=A=>b.$emit("close")),class:"text-white hover:text-gray-200 text-2xl font-bold"}," × ")]),r[7]||(r[7]=e("p",{class:"text-white text-sm mt-2"},"Let us know about any issues or concerns you have",-1))]),e("div",Ke,[e("form",{onSubmit:ee(I,["prevent"])},[e("div",et,[r[9]||(r[9]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Complaint Type ",-1)),G(e("select",{"onUpdate:modelValue":r[1]||(r[1]=A=>B.value=A),class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent"},[...r[8]||(r[8]=[L('<option value="">Select a type</option><option value="workplace">Workplace Issue</option><option value="schedule">Schedule Concern</option><option value="payment">Payment Issue</option><option value="harassment">Harassment/Discrimination</option><option value="technical">Technical Problem</option><option value="other">Other</option>',7)])],512),[[we,B.value]])]),e("div",tt,[r[10]||(r[10]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Describe Your Complaint ",-1)),G(e("textarea",{"onUpdate:modelValue":r[2]||(r[2]=A=>x.value=A),rows:"6",placeholder:"Please provide as much detail as possible...",class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent resize-none",required:""},null,512),[[_e,x.value]]),e("p",st," Minimum 10 characters • "+m(x.value.length)+"/1000 ",1)]),e("div",ot,[e("label",rt,[G(e("input",{type:"checkbox","onUpdate:modelValue":r[3]||(r[3]=A=>_.value=A),class:"w-4 h-4 text-red-600 border-gray-300 rounded focus:ring-red-500"},null,512),[[Se,_.value]]),r[11]||(r[11]=e("span",{class:"ml-2 text-sm text-gray-700"},"Submit anonymously",-1))])]),e("div",at,[e("button",{type:"button",onClick:r[4]||(r[4]=A=>b.$emit("close")),class:"px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 font-medium"}," Cancel "),e("button",{type:"submit",disabled:k.value||x.value.length<10,class:"px-6 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 font-medium disabled:opacity-50 disabled:cursor-not-allowed"},m(k.value?"Submitting...":"Submit Complaint"),9,nt)])],32)])])]))}},it={class:"min-h-screen bg-gradient-to-br from-indigo-50 via-purple-50 to-pink-50"},dt={key:1,class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},ct={class:"mb-8 sm:mb-12"},ut={class:"flex flex-col lg:flex-row lg:items-center lg:justify-between space-y-4 lg:space-y-0"},mt={class:"space-y-2"},pt={class:"flex flex-col sm:flex-row sm:items-center sm:space-x-3 space-y-2 sm:space-y-0"},gt={class:"text-gray-600 text-sm sm:text-base lg:text-lg"},vt={class:"font-semibold text-gray-900"},ft={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6 lg:gap-8 mb-8 sm:mb-12"},xt={class:"group bg-white/80 backdrop-blur-sm rounded-2xl shadow-xl border border-white/20 p-4 sm:p-6 lg:p-8 hover:shadow-2xl hover:-translate-y-2 transition-all duration-300 relative overflow-hidden"},ht={class:"relative z-10"},bt={class:"text-3xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent"},yt={class:"group bg-white/80 backdrop-blur-sm rounded-2xl shadow-xl border border-white/20 p-4 sm:p-6 lg:p-8 hover:shadow-2xl hover:-translate-y-2 transition-all duration-300 relative overflow-hidden"},kt={class:"relative z-10"},wt={class:"text-3xl font-bold bg-gradient-to-r from-orange-600 to-amber-600 bg-clip-text text-transparent"},_t={class:"group bg-white/80 backdrop-blur-sm rounded-2xl shadow-xl border border-white/20 p-4 sm:p-6 lg:p-8 hover:shadow-2xl hover:-translate-y-2 transition-all duration-300 relative overflow-hidden"},St={class:"relative z-10"},Ct={class:"text-3xl font-bold bg-gradient-to-r from-emerald-600 to-green-600 bg-clip-text text-transparent"},Tt={class:"group bg-white/80 backdrop-blur-sm rounded-2xl shadow-xl border border-white/20 p-4 sm:p-6 lg:p-8 hover:shadow-2xl hover:-translate-y-2 transition-all duration-300 relative overflow-hidden"},$t={class:"relative z-10"},At={class:"text-3xl font-bold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent"},Dt={class:"grid grid-cols-1 lg:grid-cols-3 gap-8 mb-12"},Mt={class:"lg:col-span-1"},Rt={class:"bg-white/80 backdrop-blur-sm rounded-2xl shadow-xl border border-white/20 p-6 hover:shadow-2xl transition-all duration-300"},Ut={class:"lg:col-span-2"},jt={class:"bg-white/80 backdrop-blur-sm rounded-2xl shadow-xl border border-white/20 p-4 sm:p-6 lg:p-8 hover:shadow-2xl transition-all duration-300"},Bt={class:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4"},It={key:0,class:"col-span-1 md:col-span-2"},Et={key:0,class:"bg-gradient-to-r from-green-50 to-blue-50 rounded-lg border-2 border-green-200 p-6"},Ht={class:"flex items-center justify-between"},Lt={class:"flex items-center"},Vt={class:"text-sm text-gray-600"},Wt=["disabled"],Ft={key:1,class:"bg-gradient-to-r from-green-100 to-blue-100 rounded-lg border-2 border-green-400 p-6"},Ot={class:"text-center"},Nt={class:"flex items-center justify-center mb-3"},zt={class:"font-bold text-4xl text-gray-900 font-mono"},Pt={class:"text-sm text-gray-700 font-medium"},Jt={class:"text-xs text-gray-600 mt-1"},Yt={class:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8"},Zt={class:"bg-white rounded-xl shadow-sm border border-gray-200 p-6"},Qt={class:"h-64 relative"},Gt={key:0,class:"absolute inset-0 flex items-center justify-center text-gray-500"},qt={class:"bg-white rounded-xl shadow-sm border border-gray-200 p-6"},Xt={class:"h-64 relative"},Kt={key:0,class:"absolute inset-0 flex items-center justify-center text-gray-500"},es={class:"bg-white rounded-xl shadow-sm border border-gray-200 p-6"},ts={class:"space-y-3"},ss={class:"flex-shrink-0"},os={class:"w-8 h-8 bg-gray-300 rounded-full flex items-center justify-center"},rs={class:"text-sm font-medium text-gray-700"},as={class:"flex-1 min-w-0"},ns={class:"text-sm font-medium text-gray-900"},ls={class:"text-xs text-gray-500"},is={class:"flex-shrink-0"},ys={__name:"DashboardView",setup(i){Ce();const c=g(!0),s=g(null),B=g([]),x=g(0),_=g(0),k=g(0),I=g([]),b=g(!1),r=g(!1),A=g(!1),E=g(0),u=g(8),n=g("");let a=null;const f=g(null),w=g(null);let v=null,S=null;const R=O(()=>{var o;return((o=s.value)==null?void 0:o.role)||"employee"}),C=O(()=>R.value==="admin"),W=O(()=>R.value==="manager"||R.value==="admin"),H=O(()=>Math.round(k.value)),z=async()=>{var o,t;try{if(!((o=s.value)!=null&&o.id))return;const y=new Date().toISOString().split("T")[0],T=(t=(await oe.list()).data)==null?void 0:t.find(D=>D.user_id===s.value.id&&D.date===y&&D.status==="present");if(T){r.value=!0;const D=new Date(T.inserted_at);n.value=D.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"});const l=u.value*3600,M=Math.floor((Date.now()-D.getTime())/1e3);E.value=Math.max(0,l-M),E.value>0&&Z()}}catch(y){console.error("Error checking attendance:",y)}},P=async()=>{var o,t;try{if(!((o=s.value)!=null&&o.id))return;const T=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][new Date().getDay()],l=(t=(await Ae.list(s.value.id)).data)==null?void 0:t.find(M=>M.day_of_week===T);l&&l.scheduled_hours&&(u.value=l.scheduled_hours)}catch(y){console.error("Error loading schedule:",y),u.value=8}},Y=async()=>{try{A.value=!0;const o=new Date().toISOString().split("T")[0],t=new Date;await oe.create({user_id:s.value.id,date:o,status:"present"});try{await V.toggleForUser(s.value.id,!0),console.log("Auto clock-in triggered after marking attendance")}catch(y){console.error("Error auto clocking in:",y)}r.value=!0,n.value=t.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}),E.value=u.value*3600,Z(),j.success(`Attendance marked and clocked in! Timer started for ${u.value} hours`)}catch(o){console.error("Error marking attendance:",o),j.error("Failed to mark attendance")}finally{A.value=!1}},Z=()=>{a&&clearInterval(a),a=setInterval(()=>{if(E.value>0)E.value--;else{clearInterval(a),j.warning("⏰ Time is over! Your shift has ended.");try{new Audio("data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBSuBzvLZizcIGWi77eeeTRALT6fj8LZjHAU3j9fyz3osBSJ1x/DdkEELFF+06uunVRULRp/g8r1sIgUsgs/y2Yk3CBlou+3nnk0QC0+n4/C2YxwFN4/X8tB6LAUidcfw3ZBCC").play().catch(()=>{})}catch{}}},1e3)},ce=o=>{const t=Math.floor(o/3600),y=Math.floor(o%3600/60),h=o%60;return`${t.toString().padStart(2,"0")}:${y.toString().padStart(2,"0")}:${h.toString().padStart(2,"0")}`};ne(async()=>{ue(),await X(),await te(),K(),ve(),P(),z()}),le(()=>{v&&v.destroy(),S&&S.destroy(),a&&clearInterval(a)});const ue=()=>{try{const o=localStorage.getItem("currentUser");o&&(s.value=JSON.parse(o))}catch(o){console.error("Error loading user:",o)}},X=async()=>{var o;try{if(c.value=!0,!((o=s.value)!=null&&o.id))return;const y=(await $e.list(s.value.id)).data||[],T=(await V.listByUser(s.value.id)).data||[];me(y,T),await pe()}catch(t){console.error("Error loading dashboard data:",t),j.error("Failed to load dashboard data")}finally{c.value=!1}},me=(o,t)=>{const h=new Date().toISOString().split("T")[0],T=o.filter(U=>U.start?new Date(U.start).toISOString().split("T")[0]===h:!1),D=t.filter(U=>U.time?new Date(U.time).toISOString().split("T")[0]===h:!1);x.value=T.reduce((U,F)=>{if(F.start&&F.end){const ye=new Date(F.start),ke=new Date(F.end)-ye;return U+ke/(1e3*60)}return U},0),_.value=Math.max(0,x.value*.1);const l=[];let M=null;D.forEach(U=>{U.status===!0?M={start:U.time,end:null}:U.status===!1&&M&&(M.end=U.time,l.push(M),M=null)}),M&&l.push(M),B.value=l;const J=8*60;k.value=Math.min(100,Math.round(x.value/J*100)),console.log("📊 Dashboard Time Calculation:"),console.log("Today:",h),console.log("Total working times:",o.length),console.log("Today working times:",T.length),console.log("Total clockins:",t.length),console.log("Today clockins:",D.length),console.log("Today sessions:",l.length),console.log("Today work minutes:",x.value),console.log("Today work hours:",(x.value/60).toFixed(2))},pe=async()=>{var o;try{if(!((o=s.value)!=null&&o.id))return;const y=(await V.listByUser(s.value.id)).data||[];I.value=y.slice(0,5).map((h,T)=>({id:h.id||T,user:{first_name:s.value.first_name||"You"},message:`${h.status?"Clocked in":"Clocked out"} at ${ge(h.time)}`,type:h.status?"clock_in":"clock_out",timestamp:new Date(h.time)}))}catch(t){console.error("Error loading recent activities:",t),I.value=[]}},ge=o=>new Date(o).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}),K=()=>{if(console.log("Initializing charts..."),f.value){console.log("Creating work hours chart...");try{const o=f.value.getContext("2d");v&&v.destroy(),v=new ae(o,{type:"bar",data:{labels:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],datasets:[{label:"Work Hours",data:[8,7.5,8.5,8,7,0,0],backgroundColor:["rgba(59, 130, 246, 0.8)","rgba(59, 130, 246, 0.8)","rgba(59, 130, 246, 0.8)","rgba(59, 130, 246, 0.8)","rgba(59, 130, 246, 0.8)","rgba(156, 163, 175, 0.5)","rgba(156, 163, 175, 0.5)"],borderColor:"rgb(59, 130, 246)",borderWidth:2,borderRadius:6,borderSkipped:!1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"Hours"}}}}}),console.log("Work hours chart created successfully")}catch(o){console.error("Error creating work hours chart:",o)}}else console.log("Work hours chart canvas not found");if(w.value){console.log("Creating productivity chart...");try{const o=w.value.getContext("2d");S&&S.destroy(),S=new ae(o,{type:"line",data:{labels:["Week 1","Week 2","Week 3","Week 4"],datasets:[{label:"Productivity %",data:[85,87,90,87],borderColor:"rgb(16, 185, 129)",backgroundColor:"rgba(16, 185, 129, 0.1)",borderWidth:3,pointBackgroundColor:"rgb(16, 185, 129)",pointBorderColor:"#fff",pointBorderWidth:2,pointRadius:6,tension:.4,fill:!0}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0,max:100,title:{display:!0,text:"Productivity %"}}}}}),console.log("Productivity chart created successfully")}catch(o){console.error("Error creating productivity chart:",o)}}else console.log("Productivity chart canvas not found")},ve=()=>{setInterval(()=>{k.value=Math.max(0,Math.min(100,Math.round(k.value+(Math.random()-.5)*2)))},1e4)},fe=async()=>{await X(),await te(),K(),j.success("Dashboard data refreshed")},xe=()=>{try{const o={totalEmployees:1,totalTeams:1,averageWorkHours:x.value/60,productivityScore:Math.round(k.value)};Re.exportComprehensiveReport(o),j.success("Report exported successfully")}catch(o){console.error("Error exporting report:",o),j.error("Failed to export report")}},he=()=>{j.info("Activity page will be implemented soon")},be=()=>{j.success("Your complaint has been submitted successfully!"),b.value=!1},Q=o=>{if(typeof o=="number"){const D=Math.floor(o/60),l=Math.round(o%60);return`${D}:${l.toString().padStart(2,"0")}`}const y=new Date-o,h=Math.floor(y/6e4);if(h<1)return"Just now";if(h<60)return`${h}m ago`;const T=Math.floor(h/60);return T<24?`${T}h ago`:o.toLocaleDateString()};return(o,t)=>{var y,h,T,D;return d(),p("div",it,[c.value?(d(),se(De,{key:0,show:c.value,text:"Loading dashboard data...",size:"xl",containerClass:"min-h-screen"},null,8,["show"])):(d(),p("div",dt,[e("div",ct,[e("div",ut,[e("div",mt,[t[13]||(t[13]=e("h1",{class:"text-2xl sm:text-3xl lg:text-4xl font-bold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent"}," Dashboard ",-1)),e("div",pt,[e("p",gt,[t[12]||(t[12]=q(" Welcome back, ",-1)),e("span",vt,m(((y=s.value)==null?void 0:y.username)||`${(h=s.value)==null?void 0:h.first_name} ${(T=s.value)==null?void 0:T.last_name}`),1)]),e("div",{class:N(["px-3 py-1 text-xs sm:text-sm font-medium rounded-full shadow-sm w-fit",{"bg-gradient-to-r from-purple-500 to-purple-600 text-white":R.value==="admin","bg-gradient-to-r from-blue-500 to-blue-600 text-white":R.value==="manager","bg-gradient-to-r from-green-500 to-green-600 text-white":R.value==="employee"}])},m((D=R.value)==null?void 0:D.toUpperCase()),3)])]),e("div",{class:"flex flex-col sm:flex-row items-stretch sm:items-center gap-3"},[e("button",{onClick:fe,class:"group px-4 sm:px-6 py-2.5 sm:py-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white text-sm font-semibold rounded-xl hover:from-blue-600 hover:to-blue-700 transform hover:-translate-y-1 transition-all duration-200 shadow-lg hover:shadow-xl"},[...t[14]||(t[14]=[e("svg",{class:"w-4 h-4 inline mr-2 group-hover:rotate-180 transition-transform duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1),q(" Refresh ",-1)])]),e("button",{onClick:xe,class:"group px-4 sm:px-6 py-2.5 sm:py-3 bg-gradient-to-r from-emerald-500 to-emerald-600 text-white text-sm font-semibold rounded-xl hover:from-emerald-600 hover:to-emerald-700 transform hover:-translate-y-1 transition-all duration-200 shadow-lg hover:shadow-xl"},[...t[15]||(t[15]=[e("svg",{class:"w-4 h-4 inline mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})],-1),e("span",{class:"hidden sm:inline"},"Export Report",-1),e("span",{class:"sm:hidden"},"Export",-1)])])])])]),e("div",ft,[e("div",xt,[t[17]||(t[17]=e("div",{class:"absolute inset-0 bg-gradient-to-br from-blue-500/10 to-indigo-500/10 opacity-0 group-hover:opacity-100 transition-opacity duration-300"},null,-1)),e("div",ht,[t[16]||(t[16]=L('<div class="flex items-center justify-between mb-4"><div class="p-4 bg-gradient-to-br from-blue-500 to-blue-600 rounded-2xl shadow-lg"><svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></div><div class="text-right"><p class="text-xs font-medium text-gray-500 uppercase tracking-wider">Today</p><div class="w-3 h-3 bg-green-500 rounded-full animate-pulse"></div></div></div><h3 class="text-sm font-semibold text-gray-600 mb-2">Total Work Time</h3>',2)),e("p",bt,m(Q(x.value)),1)])]),e("div",yt,[t[19]||(t[19]=e("div",{class:"absolute inset-0 bg-gradient-to-br from-orange-500/10 to-amber-500/10 opacity-0 group-hover:opacity-100 transition-opacity duration-300"},null,-1)),e("div",kt,[t[18]||(t[18]=L('<div class="flex items-center justify-between mb-4"><div class="p-4 bg-gradient-to-br from-orange-500 to-amber-500 rounded-2xl shadow-lg"><svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path></svg></div><div class="text-right"><p class="text-xs font-medium text-gray-500 uppercase tracking-wider">Today</p><div class="w-3 h-3 bg-green-500 rounded-full animate-pulse"></div></div></div><h3 class="text-sm font-semibold text-gray-600 mb-2">Break Time</h3>',2)),e("p",wt,m(Q(_.value)),1)])]),e("div",_t,[t[21]||(t[21]=e("div",{class:"absolute inset-0 bg-gradient-to-br from-emerald-500/10 to-green-500/10 opacity-0 group-hover:opacity-100 transition-opacity duration-300"},null,-1)),e("div",St,[t[20]||(t[20]=L('<div class="flex items-center justify-between mb-4"><div class="p-4 bg-gradient-to-br from-emerald-500 to-green-500 rounded-2xl shadow-lg"><svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path></svg></div><div class="text-right"><p class="text-xs font-medium text-gray-500 uppercase tracking-wider">Today</p><div class="w-3 h-3 bg-green-500 rounded-full animate-pulse"></div></div></div><h3 class="text-sm font-semibold text-gray-600 mb-2">Sessions</h3>',2)),e("p",Ct,m(B.value.length),1)])]),e("div",Tt,[t[23]||(t[23]=e("div",{class:"absolute inset-0 bg-gradient-to-br from-purple-500/10 to-pink-500/10 opacity-0 group-hover:opacity-100 transition-opacity duration-300"},null,-1)),e("div",$t,[t[22]||(t[22]=L('<div class="flex items-center justify-between mb-4"><div class="p-4 bg-gradient-to-br from-purple-500 to-pink-500 rounded-2xl shadow-lg"><svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></div><div class="text-right"><p class="text-xs font-medium text-gray-500 uppercase tracking-wider">Today</p><div class="w-3 h-3 bg-green-500 rounded-full animate-pulse"></div></div></div><h3 class="text-sm font-semibold text-gray-600 mb-2">Productivity</h3>',2)),e("p",At,m(H.value)+"%",1)])])]),e("div",Dt,[e("div",Mt,[e("div",Rt,[Te(Qe)])]),e("div",Ut,[e("div",jt,[t[38]||(t[38]=L('<div class="flex items-center mb-4 sm:mb-6"><div class="p-2 sm:p-3 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-xl shadow-lg mr-3 sm:mr-4"><svg class="w-5 h-5 sm:w-6 sm:h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg></div><h3 class="text-xl sm:text-2xl font-bold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent">Quick Actions</h3></div>',1)),e("div",Bt,[C.value?$("",!0):(d(),p("div",It,[r.value?(d(),p("div",Ft,[e("div",Ot,[e("div",Nt,[t[26]||(t[26]=e("span",{class:"text-3xl mr-3"},"⏱️",-1)),e("div",zt,m(ce(E.value)),1)]),e("div",Pt,m(E.value>0?"Time remaining in your shift":"🎉 Shift completed!"),1),e("div",Jt," Scheduled: "+m(u.value)+" hours | Started: "+m(n.value),1)])])):(d(),p("div",Et,[e("div",Ht,[e("div",Lt,[t[25]||(t[25]=e("span",{class:"text-3xl mr-4"},"✅",-1)),e("div",null,[t[24]||(t[24]=e("div",{class:"font-semibold text-gray-900 text-lg"},"Mark Your Attendance",-1)),e("div",Vt,"Start your workday timer ("+m(u.value)+" hours)",1)])]),e("button",{onClick:Y,disabled:A.value,class:"px-6 py-3 bg-green-600 text-white font-medium rounded-lg hover:bg-green-700 disabled:opacity-50 transition-colors"},m(A.value?"Marking...":"Mark Present"),9,Wt)])]))])),C.value?$("",!0):(d(),p("button",{key:1,onClick:t[0]||(t[0]=l=>o.$router.push("/clockins")),class:"flex items-center justify-center p-4 bg-blue-50 rounded-lg hover:bg-blue-100 transition-colors"},[...t[27]||(t[27]=[e("span",{class:"text-2xl mr-3"},"🕐",-1),e("div",{class:"text-left"},[e("div",{class:"font-medium text-gray-900"},"Clock In/Out"),e("div",{class:"text-sm text-gray-500"},"Manual time tracking")],-1)])])),C.value?$("",!0):(d(),p("button",{key:2,onClick:t[1]||(t[1]=l=>o.$router.push("/working-times")),class:"flex items-center justify-center p-4 bg-green-50 rounded-lg hover:bg-green-100 transition-colors"},[...t[28]||(t[28]=[e("span",{class:"text-2xl mr-3"},"📅",-1),e("div",{class:"text-left"},[e("div",{class:"font-medium text-gray-900"},"Working Times"),e("div",{class:"text-sm text-gray-500"},"View your schedule")],-1)])])),C.value?$("",!0):(d(),p("button",{key:3,onClick:t[2]||(t[2]=l=>o.$router.push("/user-schedule")),class:"flex items-center justify-center p-4 bg-purple-50 rounded-lg hover:bg-purple-100 transition-colors"},[...t[29]||(t[29]=[e("span",{class:"text-2xl mr-3"},"⚙️",-1),e("div",{class:"text-left"},[e("div",{class:"font-medium text-gray-900"},"Set Schedule"),e("div",{class:"text-sm text-gray-500"},"Configure your hours")],-1)])])),C.value?$("",!0):(d(),p("button",{key:4,onClick:t[3]||(t[3]=l=>o.$router.push("/weekly-timesheet")),class:"flex items-center justify-center p-4 bg-orange-50 rounded-lg hover:bg-orange-100 transition-colors"},[...t[30]||(t[30]=[e("span",{class:"text-2xl mr-3"},"📊",-1),e("div",{class:"text-left"},[e("div",{class:"font-medium text-gray-900"},"Weekly Timesheet"),e("div",{class:"text-sm text-gray-500"},"Track your hours")],-1)])])),C.value?$("",!0):(d(),p("button",{key:5,onClick:t[4]||(t[4]=l=>o.$router.push("/attendance-calendar")),class:"flex items-center justify-center p-4 bg-indigo-50 rounded-lg hover:bg-indigo-100 transition-colors"},[...t[31]||(t[31]=[e("span",{class:"text-2xl mr-3"},"📆",-1),e("div",{class:"text-left"},[e("div",{class:"font-medium text-gray-900"},"Attendance Calendar"),e("div",{class:"text-sm text-gray-500"},"View monthly attendance")],-1)])])),C.value?$("",!0):(d(),p("button",{key:6,onClick:t[5]||(t[5]=l=>b.value=!0),class:"flex items-center justify-center p-4 bg-red-50 rounded-lg hover:bg-red-100 transition-colors"},[...t[32]||(t[32]=[e("span",{class:"text-2xl mr-3"},"📝",-1),e("div",{class:"text-left"},[e("div",{class:"font-medium text-gray-900"},"Submit Complaint"),e("div",{class:"text-sm text-gray-500"},"Report an issue")],-1)])])),C.value?$("",!0):(d(),p("button",{key:7,onClick:t[6]||(t[6]=l=>o.$router.push("/my-complaints")),class:"flex items-center justify-center p-4 bg-blue-50 rounded-lg hover:bg-blue-100 transition-colors"},[...t[33]||(t[33]=[e("span",{class:"text-2xl mr-3"},"💬",-1),e("div",{class:"text-left"},[e("div",{class:"font-medium text-gray-900"},"My Complaints"),e("div",{class:"text-sm text-gray-500"},"View responses")],-1)])])),W.value?(d(),p("button",{key:8,onClick:t[7]||(t[7]=l=>o.$router.push("/teams")),class:"flex items-center justify-center p-4 bg-indigo-50 rounded-lg hover:bg-indigo-100 transition-colors"},[...t[34]||(t[34]=[e("span",{class:"text-2xl mr-3"},"👥",-1),e("div",{class:"text-left"},[e("div",{class:"font-medium text-gray-900"},"Manage Teams"),e("div",{class:"text-sm text-gray-500"},"View team members")],-1)])])):$("",!0),W.value&&!C.value?(d(),p("button",{key:9,onClick:t[8]||(t[8]=l=>o.$router.push("/timesheet-approvals")),class:"flex items-center justify-center p-4 bg-yellow-50 rounded-lg hover:bg-yellow-100 transition-colors"},[...t[35]||(t[35]=[e("span",{class:"text-2xl mr-3"},"✅",-1),e("div",{class:"text-left"},[e("div",{class:"font-medium text-gray-900"},"Approve Timesheets"),e("div",{class:"text-sm text-gray-500"},"Review submissions")],-1)])])):$("",!0),C.value?(d(),p("button",{key:10,onClick:t[9]||(t[9]=l=>o.$router.push("/admin/users")),class:"flex items-center justify-center p-4 bg-red-50 rounded-lg hover:bg-red-100 transition-colors"},[...t[36]||(t[36]=[e("span",{class:"text-2xl mr-3"},"👤",-1),e("div",{class:"text-left"},[e("div",{class:"font-medium text-gray-900"},"Manage Users"),e("div",{class:"text-sm text-gray-500"},"User administration")],-1)])])):$("",!0),C.value?(d(),p("button",{key:11,onClick:t[10]||(t[10]=l=>o.$router.push("/admin/teams")),class:"flex items-center justify-center p-4 bg-pink-50 rounded-lg hover:bg-pink-100 transition-colors"},[...t[37]||(t[37]=[e("span",{class:"text-2xl mr-3"},"🏢",-1),e("div",{class:"text-left"},[e("div",{class:"font-medium text-gray-900"},"Manage Teams"),e("div",{class:"text-sm text-gray-500"},"Team administration")],-1)])])):$("",!0)])])])]),e("div",Yt,[e("div",Zt,[t[40]||(t[40]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Work Hours This Week",-1)),e("div",Qt,[e("canvas",{ref_key:"workHoursChart",ref:f,class:"w-full h-full"},null,512),f.value?$("",!0):(d(),p("div",Gt,[...t[39]||(t[39]=[e("div",{class:"text-center"},[e("div",{class:"text-4xl mb-2"},"📊"),e("div",{class:"text-sm"},"Loading chart...")],-1)])]))])]),e("div",qt,[t[42]||(t[42]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Productivity Trends",-1)),e("div",Xt,[e("canvas",{ref_key:"productivityChart",ref:w,class:"w-full h-full"},null,512),w.value?$("",!0):(d(),p("div",Kt,[...t[41]||(t[41]=[e("div",{class:"text-center"},[e("div",{class:"text-4xl mb-2"},"📈"),e("div",{class:"text-sm"},"Loading chart...")],-1)])]))])])]),e("div",es,[e("div",{class:"flex items-center justify-between mb-4"},[t[43]||(t[43]=e("h3",{class:"text-lg font-semibold text-gray-900"},"Recent Activity",-1)),e("button",{onClick:he,class:"text-blue-600 hover:text-blue-800 text-sm font-medium"}," View All → ")]),e("div",ts,[(d(!0),p(ie,null,de(I.value,l=>{var M,J;return d(),p("div",{key:l.id,class:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg"},[e("div",ss,[e("div",os,[e("span",rs,m((J=(M=l.user)==null?void 0:M.first_name)==null?void 0:J[0]),1)])]),e("div",as,[e("p",ns,m(l.message),1),e("p",ls,m(Q(l.timestamp)),1)]),e("div",is,[e("span",{class:N(["px-2 py-1 text-xs font-medium rounded-full",l.type==="clock_in"?"bg-green-100 text-green-800":l.type==="clock_out"?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"])},m(l.type==="clock_in"?"In":l.type==="clock_out"?"Out":"Activity"),3)])])}),128))])])])),b.value?(d(),se(lt,{key:2,onClose:t[11]||(t[11]=l=>b.value=!1),onSubmitted:be})):$("",!0)])}}};export{ys as default};
