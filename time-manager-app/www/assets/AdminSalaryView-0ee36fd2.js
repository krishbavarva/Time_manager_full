import{r as u,f as D,g as I,m,o as a,c as l,a as e,w as J,v as K,b as j,e as M,t as r,F as $,i as F,n as W}from"./index-5e39243b.js";import{h as v}from"./http-8cebfae0.js";const f={getWeeklySalaries:(i=null)=>{const n=i?`?week_start=${i}`:"";return v.get(`/api/salaries/weekly${n}`)},getUserWeeklySalary:(i,n=null)=>{const d=n?`?week_start=${n}`:"";return v.get(`/api/salaries/user/${i}/weekly${d}`)},getOvertimeDetails:(i,n=null)=>{const d=n?`?week_start=${n}`:"";return v.get(`/api/salaries/overtime/${i}${d}`)},approveOvertime:i=>v.post(`/api/salaries/overtime/${i}/approve`),rejectOvertime:i=>v.post(`/api/salaries/overtime/${i}/reject`)},Q={class:"min-h-screen bg-gray-50 py-8"},X={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},Y={class:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6"},Z={class:"flex flex-wrap items-center gap-4"},ee={class:"flex items-center gap-2"},te=["disabled"],se={key:0,class:"animate-spin h-4 w-4 inline mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},oe={class:"mt-4 text-sm text-gray-600"},re={class:"font-semibold"},ae={class:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6"},le={class:"bg-white rounded-xl shadow-sm border border-gray-200 p-6"},ne={class:"flex items-center"},ie={class:"ml-4"},de={class:"text-2xl font-bold text-gray-900"},ce={class:"bg-white rounded-xl shadow-sm border border-gray-200 p-6"},pe={class:"flex items-center"},ue={class:"ml-4"},xe={class:"text-2xl font-bold text-gray-900"},me={class:"bg-white rounded-xl shadow-sm border border-gray-200 p-6"},ge={class:"flex items-center"},ve={class:"ml-4"},ye={class:"text-2xl font-bold text-gray-900"},he={class:"bg-white rounded-xl shadow-sm border border-gray-200 p-6"},_e={class:"flex items-center"},fe={class:"ml-4"},we={class:"text-2xl font-bold text-gray-900"},be={class:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden"},ke={class:"px-6 py-4 border-b border-gray-200"},De={class:"text-sm text-gray-600"},Oe={class:"overflow-x-auto"},Ce={class:"min-w-full divide-y divide-gray-200"},Se={class:"bg-white divide-y divide-gray-200"},je={class:"px-6 py-4 whitespace-nowrap"},Me={class:"flex items-center"},$e={class:"flex-shrink-0 h-10 w-10"},Fe={class:"h-10 w-10 rounded-full bg-blue-500 flex items-center justify-center"},We={class:"text-sm font-medium text-white"},Be={class:"ml-4"},Ae={class:"text-sm font-medium text-gray-900"},Ee={class:"text-sm text-gray-500"},ze={class:"px-6 py-4 whitespace-nowrap"},Pe={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Re={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Ve={class:"px-6 py-4 whitespace-nowrap"},He={class:"text-sm"},Le={class:"text-yellow-600 font-medium"},Ne={class:"text-green-600 font-medium"},Te={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Ue={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-green-600"},qe={class:"px-6 py-4 whitespace-nowrap text-sm font-bold text-gray-900"},Ge={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},Ie=["onClick"],Je={key:1,class:"text-gray-400"},Ke={key:0,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},Qe={class:"relative top-20 mx-auto p-5 border w-full max-w-4xl shadow-lg rounded-md bg-white"},Xe={class:"mt-3"},Ye={class:"flex items-center justify-between mb-6"},Ze={class:"text-xl font-medium text-gray-900"},et={key:0,class:"text-center py-8"},tt={key:1},st={key:0},ot={class:"min-w-full divide-y divide-gray-200"},rt={class:"bg-white divide-y divide-gray-200"},at={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},lt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},nt={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-orange-600"},it={class:"px-6 py-4 whitespace-nowrap"},dt={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},ct={key:0,class:"flex gap-2"},pt=["onClick","disabled"],ut=["onClick","disabled"],xt={key:1,class:"text-gray-500"},mt={key:1,class:"text-center py-8 text-gray-500"},yt={__name:"AdminSalaryView",setup(i){const n=u(!1),d=u([]),c=u(""),w=u(!1),g=u(null),y=u([]),b=u(!1),h=u({}),_=u({}),B=D(()=>d.value.reduce((s,t)=>s+t.total_salary,0)),A=D(()=>d.value.reduce((s,t)=>s+t.pending_overtime_hours,0)),E=D(()=>d.value.reduce((s,t)=>s+t.approved_overtime_hours,0));I(()=>{O(),x()});const z=s=>{const t=new Date(s),p=t.getDay(),o=t.getDate()-p+(p===0?-6:1);return new Date(t.setDate(o))},O=()=>{const s=z(new Date);c.value=s.toISOString().split("T")[0]},P=()=>{const s=new Date(c.value);s.setDate(s.getDate()-7),c.value=s.toISOString().split("T")[0],x()},R=()=>{const s=new Date(c.value);s.setDate(s.getDate()+7),c.value=s.toISOString().split("T")[0],x()},V=s=>{if(!s)return"";const t=new Date(s),p=new Date(t);return p.setDate(p.getDate()+6),`${t.toLocaleDateString()} - ${p.toLocaleDateString()}`},H=s=>new Date(s).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"}),L=s=>s?s.split(" ").map(t=>t[0]).join("").toUpperCase().slice(0,2):"??",N=s=>({manager:"bg-blue-100 text-blue-800",employee:"bg-green-100 text-green-800"})[s]||"bg-gray-100 text-gray-800",T=s=>({pending:"bg-yellow-100 text-yellow-800",approved:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800"})[s]||"bg-gray-100 text-gray-800",x=async()=>{try{n.value=!0;const s=await f.getWeeklySalaries(c.value);d.value=s.data||[]}catch(s){console.error("Error loading salary data:",s),m.error("Failed to load salary data")}finally{n.value=!1}},U=async s=>{g.value=s,w.value=!0,await k(s.user_id)},C=()=>{w.value=!1,g.value=null,y.value=[]},k=async s=>{try{b.value=!0;const t=await f.getOvertimeDetails(s,c.value);y.value=t.data||[]}catch(t){console.error("Error loading overtime details:",t),m.error("Failed to load overtime details")}finally{b.value=!1}},q=async s=>{try{h.value[s]=!0,await f.approveOvertime(s),m.success("Overtime approved!"),await k(g.value.user_id),await x()}catch(t){console.error("Error approving overtime:",t),m.error("Failed to approve overtime")}finally{h.value[s]=!1}},G=async s=>{try{_.value[s]=!0,await f.rejectOvertime(s),m.success("Overtime rejected"),await k(g.value.user_id),await x()}catch(t){console.error("Error rejecting overtime:",t),m.error("Failed to reject overtime")}finally{_.value[s]=!1}};return(s,t)=>{var p;return a(),l("div",Q,[e("div",X,[t[15]||(t[15]=e("div",{class:"mb-8"},[e("h1",{class:"text-3xl font-bold text-gray-900"},"Salary Management"),e("p",{class:"mt-2 text-sm text-gray-600"},"Manage employee and manager weekly salaries and overtime approvals")],-1)),e("div",Y,[e("div",Z,[e("div",ee,[t[1]||(t[1]=e("label",{class:"text-sm font-medium text-gray-700"},"Week Starting:",-1)),J(e("input",{"onUpdate:modelValue":t[0]||(t[0]=o=>c.value=o),type:"date",onChange:x,class:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,544),[[K,c.value]])]),e("div",{class:"flex gap-2"},[e("button",{onClick:P,class:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors"}," ← Previous Week "),e("button",{onClick:O,class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"}," Current Week "),e("button",{onClick:R,class:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors"}," Next Week → ")]),e("button",{onClick:x,disabled:n.value,class:"ml-auto px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 transition-colors"},[n.value?(a(),l("svg",se,[...t[2]||(t[2]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])])):j("",!0),M(" "+r(n.value?"Loading...":"Refresh"),1)],8,te)]),e("div",oe,[t[3]||(t[3]=M(" Showing week: ",-1)),e("span",re,r(V(c.value)),1)])]),e("div",ae,[e("div",le,[e("div",ne,[t[5]||(t[5]=e("div",{class:"p-3 rounded-full bg-blue-100"},[e("svg",{class:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"})])],-1)),e("div",ie,[t[4]||(t[4]=e("p",{class:"text-sm font-medium text-gray-600"},"Total Employees",-1)),e("p",de,r(d.value.length),1)])])]),e("div",ce,[e("div",pe,[t[7]||(t[7]=e("div",{class:"p-3 rounded-full bg-green-100"},[e("svg",{class:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),e("div",ue,[t[6]||(t[6]=e("p",{class:"text-sm font-medium text-gray-600"},"Total Payroll",-1)),e("p",xe,"€"+r(B.value.toFixed(2)),1)])])]),e("div",me,[e("div",ge,[t[9]||(t[9]=e("div",{class:"p-3 rounded-full bg-orange-100"},[e("svg",{class:"w-6 h-6 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),e("div",ve,[t[8]||(t[8]=e("p",{class:"text-sm font-medium text-gray-600"},"Pending Overtime",-1)),e("p",ye,r(A.value.toFixed(1))+"h",1)])])]),e("div",he,[e("div",_e,[t[11]||(t[11]=e("div",{class:"p-3 rounded-full bg-purple-100"},[e("svg",{class:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),e("div",fe,[t[10]||(t[10]=e("p",{class:"text-sm font-medium text-gray-600"},"Approved Overtime",-1)),e("p",we,r(E.value.toFixed(1))+"h",1)])])])]),e("div",be,[e("div",ke,[t[12]||(t[12]=e("h3",{class:"text-lg font-semibold text-gray-900"},"Weekly Salary Breakdown",-1)),e("p",De,r(d.value.length)+" employees/managers",1)]),e("div",Oe,[e("table",Ce,[t[14]||(t[14]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Employee"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Role"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Hourly Rate"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Base Hours"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Overtime (P/A)"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Base Salary"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Overtime Pay"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Total Salary"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),e("tbody",Se,[(a(!0),l($,null,F(d.value,o=>(a(),l("tr",{key:o.user_id,class:"hover:bg-gray-50"},[e("td",je,[e("div",Me,[e("div",$e,[e("div",Fe,[e("span",We,r(L(o.user_name)),1)])]),e("div",Be,[e("div",Ae,r(o.user_name),1),e("div",Ee,r(o.user_email),1)])])]),e("td",ze,[e("span",{class:W(["inline-flex px-2 py-1 text-xs font-semibold rounded-full",N(o.user_role)])},r(o.user_role),3)]),e("td",Pe," €"+r(o.hourly_rate.toFixed(2))+"/h ",1),e("td",Re,r(o.base_hours)+"h ",1),e("td",Ve,[e("div",He,[e("span",Le,r(o.pending_overtime_hours)+"h",1),t[13]||(t[13]=e("span",{class:"text-gray-400"}," / ",-1)),e("span",Ne,r(o.approved_overtime_hours)+"h",1)])]),e("td",Te," €"+r(o.base_salary.toFixed(2)),1),e("td",Ue," €"+r(o.overtime_pay.toFixed(2)),1),e("td",qe," €"+r(o.total_salary.toFixed(2)),1),e("td",Ge,[o.pending_overtime_hours>0||o.approved_overtime_hours>0?(a(),l("button",{key:0,onClick:S=>U(o),class:"text-blue-600 hover:text-blue-900"}," View Overtime ",8,Ie)):(a(),l("span",Je,"No overtime"))])]))),128))])])])])]),w.value?(a(),l("div",Ke,[e("div",Qe,[e("div",Xe,[e("div",Ye,[e("h3",Ze," Overtime Details - "+r((p=g.value)==null?void 0:p.user_name),1),e("button",{onClick:C,class:"text-gray-400 hover:text-gray-600 text-2xl"}," ✕ ")]),b.value?(a(),l("div",et,[...t[16]||(t[16]=[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"},null,-1),e("p",{class:"mt-2 text-gray-600"},"Loading overtime details...",-1)])])):(a(),l("div",tt,[y.value.length>0?(a(),l("div",st,[e("table",ot,[t[17]||(t[17]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Date"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Hours"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Overtime"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Status"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Actions")])],-1)),e("tbody",rt,[(a(!0),l($,null,F(y.value,o=>(a(),l("tr",{key:o.id,class:"hover:bg-gray-50"},[e("td",at,r(H(o.date)),1),e("td",lt,r(o.scheduled_hours)+"h / "+r(o.actual_hours)+"h ",1),e("td",nt," +"+r(o.overtime_hours)+"h ",1),e("td",it,[e("span",{class:W(["inline-flex px-2 py-1 text-xs font-semibold rounded-full",T(o.status)])},r(o.status),3)]),e("td",dt,[o.status==="pending"?(a(),l("div",ct,[e("button",{onClick:S=>q(o.id),disabled:h.value[o.id],class:"px-3 py-1 bg-green-600 text-white rounded hover:bg-green-700 disabled:opacity-50"},r(h.value[o.id]?"Approving...":"Approve"),9,pt),e("button",{onClick:S=>G(o.id),disabled:_.value[o.id],class:"px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700 disabled:opacity-50"},r(_.value[o.id]?"Rejecting...":"Reject"),9,ut)])):(a(),l("span",xt,r(o.status),1))])]))),128))])])])):(a(),l("div",mt," No overtime entries found for this week. "))])),e("div",{class:"mt-6 flex justify-end"},[e("button",{onClick:C,class:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700"}," Close ")])])])])):j("",!0)])}}};export{yt as default};
