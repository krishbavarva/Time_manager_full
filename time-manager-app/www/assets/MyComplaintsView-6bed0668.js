import{c as p}from"./complaints-01b8095a.js";import{r as x,f as r,g as y,o as l,c as d,a as e,t as o,s as w,F as b,i as k,d as C,m as _,n as S,b as j}from"./index-5e39243b.js";import{_ as B}from"./LoadingSpinner-e7779de2.js";import"./http-8cebfae0.js";const D={class:"min-h-screen bg-gray-50 py-8"},M={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},N={class:"mb-8"},V={class:"flex items-center justify-between"},I={class:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8"},U={class:"bg-white overflow-hidden shadow rounded-lg"},$={class:"p-5"},L={class:"flex items-center"},F={class:"flex-shrink-0"},Y={class:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center"},z={class:"text-white text-sm font-medium"},A={class:"ml-5 w-0 flex-1"},E={class:"text-lg font-medium text-gray-900"},P={class:"bg-white overflow-hidden shadow rounded-lg"},R={class:"p-5"},J={class:"flex items-center"},O={class:"flex-shrink-0"},T={class:"w-8 h-8 bg-yellow-500 rounded-full flex items-center justify-center"},q={class:"text-white text-sm font-medium"},G={class:"ml-5 w-0 flex-1"},H={class:"text-lg font-medium text-gray-900"},K={class:"bg-white overflow-hidden shadow rounded-lg"},Q={class:"p-5"},W={class:"flex items-center"},X={class:"flex-shrink-0"},Z={class:"w-8 h-8 bg-green-500 rounded-full flex items-center justify-center"},ee={class:"text-white text-sm font-medium"},te={class:"ml-5 w-0 flex-1"},se={class:"text-lg font-medium text-gray-900"},oe={class:"bg-white overflow-hidden shadow rounded-lg"},ne={class:"p-5"},ie={class:"flex items-center"},le={class:"flex-shrink-0"},de={class:"w-8 h-8 bg-gray-500 rounded-full flex items-center justify-center"},ae={class:"text-white text-sm font-medium"},re={class:"ml-5 w-0 flex-1"},ce={class:"text-lg font-medium text-gray-900"},ue={key:0,class:"flex justify-center items-center py-12"},me={key:1,class:"bg-white shadow overflow-hidden sm:rounded-md"},ge={class:"divide-y divide-gray-200"},xe={class:"flex items-center justify-between"},_e={class:"flex-1 min-w-0"},he={class:"flex items-center justify-between"},fe={class:"text-sm font-medium text-gray-900 truncate"},ve={class:"ml-2 flex-shrink-0 flex"},pe={class:"mt-2 flex items-center text-sm text-gray-500"},ye={class:"text-xs"},we={key:0,class:"mt-3 p-3 bg-gray-50 rounded-lg"},be={class:"flex items-center mb-2"},ke={class:"ml-2 text-xs text-gray-500"},Ce={class:"text-sm text-gray-700"},Se={key:1,class:"mt-3 p-3 bg-yellow-50 rounded-lg"},je={key:2,class:"text-center py-12"},Be={class:"mt-6"},Ue={__name:"MyComplaintsView",setup(De){const a=x(!0),i=x([]),c=r(()=>i.value.filter(t=>t.status==="pending").length),u=r(()=>i.value.filter(t=>t.status==="resolved").length),m=r(()=>i.value.filter(t=>t.status==="closed").length),h=async()=>{try{a.value=!0;const t=f();if(console.log("Loading complaints for user ID:",t),!t){console.error("No user ID found in localStorage"),_.error("User not authenticated. Please log in again."),i.value=[];return}const s=await p.listByUser(t);i.value=s.data||[]}catch(t){console.error("Error loading complaints:",t),_.error("Failed to load complaints")}finally{a.value=!1}},f=()=>{const t=JSON.parse(localStorage.getItem("currentUser")||"{}");return console.log("Current user from localStorage:",t),(t==null?void 0:t.id)||(t==null?void 0:t.user_id)},g=t=>t?new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",v=t=>{switch(t){case"pending":return"bg-yellow-100 text-yellow-800";case"resolved":return"bg-green-100 text-green-800";case"closed":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}};return y(()=>{h()}),(t,s)=>(l(),d("div",D,[e("div",M,[e("div",N,[e("div",V,[s[2]||(s[2]=e("div",null,[e("h1",{class:"text-3xl font-bold text-gray-900"},"My Complaints"),e("p",{class:"mt-2 text-gray-600"},"View your submitted complaints and admin responses")],-1)),e("button",{onClick:s[0]||(s[0]=n=>t.$router.push("/dashboard")),class:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50"}," ← Back to Dashboard ")])]),e("div",I,[e("div",U,[e("div",$,[e("div",L,[e("div",F,[e("div",Y,[e("span",z,o(i.value.length),1)])]),e("div",A,[e("dl",null,[s[3]||(s[3]=e("dt",{class:"text-sm font-medium text-gray-500 truncate"},"Total Complaints",-1)),e("dd",E,o(i.value.length),1)])])])])]),e("div",P,[e("div",R,[e("div",J,[e("div",O,[e("div",T,[e("span",q,o(c.value),1)])]),e("div",G,[e("dl",null,[s[4]||(s[4]=e("dt",{class:"text-sm font-medium text-gray-500 truncate"},"Pending",-1)),e("dd",H,o(c.value),1)])])])])]),e("div",K,[e("div",Q,[e("div",W,[e("div",X,[e("div",Z,[e("span",ee,o(u.value),1)])]),e("div",te,[e("dl",null,[s[5]||(s[5]=e("dt",{class:"text-sm font-medium text-gray-500 truncate"},"Resolved",-1)),e("dd",se,o(u.value),1)])])])])]),e("div",oe,[e("div",ne,[e("div",ie,[e("div",le,[e("div",de,[e("span",ae,o(m.value),1)])]),e("div",re,[e("dl",null,[s[6]||(s[6]=e("dt",{class:"text-sm font-medium text-gray-500 truncate"},"Closed",-1)),e("dd",ce,o(m.value),1)])])])])])]),a.value?(l(),d("div",ue,[w(B)])):i.value.length>0?(l(),d("div",me,[e("ul",ge,[(l(!0),d(b,null,k(i.value,n=>(l(),d("li",{key:n.id,class:"px-6 py-4"},[e("div",xe,[e("div",_e,[e("div",he,[e("p",fe,o(n.complaint),1),e("div",ve,[e("span",{class:S([v(n.status),"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"])},o(n.status),3)])]),e("div",pe,[e("p",ye," Submitted: "+o(g(n.inserted_at)),1)]),n.admin_response?(l(),d("div",we,[e("div",be,[s[7]||(s[7]=e("span",{class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800"}," Admin Response ",-1)),e("span",ke,o(g(n.updated_at)),1)]),e("p",Ce,o(n.admin_response),1)])):n.status==="pending"?(l(),d("div",Se,[...s[8]||(s[8]=[e("p",{class:"text-sm text-yellow-700"}," ⏳ Your complaint is being reviewed. You will receive a response soon. ",-1)])])):j("",!0)])])]))),128))])])):(l(),d("div",je,[s[9]||(s[9]=C('<div class="mx-auto h-12 w-12 text-gray-400"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path></svg></div><h3 class="mt-2 text-sm font-medium text-gray-900">No complaints</h3><p class="mt-1 text-sm text-gray-500">You haven&#39;t submitted any complaints yet.</p>',3)),e("div",Be,[e("button",{onClick:s[1]||(s[1]=n=>t.$router.push("/dashboard")),class:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700"}," Submit a Complaint ")])]))])]))}};export{Ue as default};
