import{u as I}from"./users-a5fc0dd3.js";import{t as U}from"./teams-0f7ee716.js";import{clockinsApi as V}from"./clockins-c9805d20.js";import{workingTimesApi as P}from"./workingTimes-d509afa4.js";import{C as W}from"./auto-69f04699.js";import{r as i,g as G,h as Z,o as g,c as u,a as t,t as a,F as S,i as T,n as q}from"./index-621cd5fc.js";import"./http-f1abb376.js";const K={class:"min-h-screen bg-gray-50 py-8 px-4 sm:px-6 lg:px-8"},Q={class:"max-w-7xl mx-auto"},X={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},Y={class:"bg-white rounded-xl shadow-sm border border-gray-200 p-6"},tt={class:"flex items-center"},st={class:"ml-4"},et={class:"text-2xl font-bold text-gray-900"},ot={class:"bg-white rounded-xl shadow-sm border border-gray-200 p-6"},at={class:"flex items-center"},rt={class:"ml-4"},nt={class:"text-2xl font-bold text-gray-900"},lt={class:"bg-white rounded-xl shadow-sm border border-gray-200 p-6"},it={class:"flex items-center"},dt={class:"ml-4"},ct={class:"text-2xl font-bold text-gray-900"},mt={class:"bg-white rounded-xl shadow-sm border border-gray-200 p-6"},gt={class:"flex items-center"},ut={class:"ml-4"},pt={class:"text-2xl font-bold text-gray-900"},xt={class:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8"},bt={class:"bg-white rounded-xl shadow-sm border border-gray-200 p-6"},ht={class:"h-64"},vt={class:"bg-white rounded-xl shadow-sm border border-gray-200 p-6"},ft={class:"h-64"},yt={class:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8"},_t={class:"bg-white rounded-xl shadow-sm border border-gray-200 p-6"},wt={class:"space-y-3"},kt={class:"flex-shrink-0"},Ct={class:"text-sm font-medium text-gray-500"},Dt={class:"flex-1 min-w-0"},St={class:"text-sm font-medium text-gray-900"},Tt={class:"text-xs text-gray-500"},At={class:"bg-white rounded-xl shadow-sm border border-gray-200 p-6"},Mt={class:"space-y-3"},Rt={class:"flex-shrink-0"},Ht={class:"flex-1 min-w-0"},Et={class:"text-sm text-gray-900"},$t={class:"text-xs text-gray-500"},It={class:"bg-white rounded-xl shadow-sm border border-gray-200 p-6"},Pt={class:"flex items-center justify-between mb-6"},Wt={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},jt={class:"flex items-center justify-between mb-3"},Bt={class:"font-medium text-gray-900"},Ot={class:"text-sm text-gray-500"},zt={class:"space-y-2"},Ft={class:"flex justify-between text-sm"},Jt={class:"text-gray-900"},Lt={class:"flex justify-between text-sm"},Nt={class:"text-blue-600"},Ut={class:"flex justify-between text-sm"},Vt={class:"text-gray-900"},es={__name:"AdminDashboard",setup(Gt){const y=i(0),h=i(0),A=i("8:30"),j=i(87),M=i([]),R=i([]),H=i([]),_=i(null),w=i(null);let k=null,C=null;G(()=>{E(),z(),F()}),Z(()=>{k&&k.destroy(),C&&C.destroy()});const E=async()=>{try{const s=(await I.list()).data||[];y.value=s.length;const e=s.map(m=>V.listByUser(m.id).catch(()=>({data:[]}))),r=await Promise.all(e);let n=0,p=0;s.forEach((m,D)=>{var $;const f=(($=r[D])==null?void 0:$.data)||[];f.length>0&&f[0].status===!0&&n++}),h.value=n;const v=(await U.list()).data||[];H.value=await Promise.all(v.map(async m=>{const D=s.filter(f=>f.team_id===m.id);return{...m,memberCount:D.length,managerName:m.manager_name||"Manager",averageHours:"8:15"}}));const x=await B(s),c=s.length>0?x/s.length:0,l=Math.floor(c),b=Math.round((c-l)*60);A.value=`${l}:${b.toString().padStart(2,"0")}`,O()}catch(o){console.error("Error loading dashboard data:",o)}},B=async o=>{let s=0;const e=new Date;for(const r of o)try{((await P.list(r.id,e.toISOString(),e.toISOString())).data||[]).forEach(d=>{if(d.start&&d.end){const v=new Date(d.start),x=new Date(d.end);s+=(x-v)/(1e3*60*60)}})}catch{}return s},O=async()=>{try{const s=(await I.list()).data||[],e=[];for(const r of s)try{const n=new Date,p=new Date(n.setDate(n.getDate()-n.getDay())),d=new Date(p);d.setDate(p.getDate()+6);const x=(await P.list(r.id,p.toISOString(),d.toISOString())).data||[];let c=0;if(x.forEach(l=>{if(l.start&&l.end){const b=new Date(l.start),m=new Date(l.end);c+=(m-b)/(1e3*60*60)}}),c>0){const l=Math.floor(c),b=Math.round((c-l)*60);e.push({id:r.id,name:`${r.first_name} ${r.last_name}`,hours:`${l}:${b.toString().padStart(2,"0")}`,totalHours:c})}}catch{}e.sort((r,n)=>n.totalHours-r.totalHours),M.value=e.slice(0,3),R.value=[{id:1,type:"info",message:`${s.length} employees currently tracked in system`,timestamp:new Date(Date.now()-30*60*1e3)},{id:2,type:"info",message:`${h.value} employees currently working`,timestamp:new Date(Date.now()-60*60*1e3)}]}catch(o){console.error("Error generating sample data:",o)}},z=()=>{if(_.value){const o=_.value.getContext("2d");k=new W(o,{type:"line",data:{labels:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],datasets:[{label:"Scheduled Hours",data:[8,8,8,8,8,0,0],borderColor:"rgb(59, 130, 246)",backgroundColor:"rgba(59, 130, 246, 0.1)",tension:.4},{label:"Actual Hours",data:[8.5,7.5,8.2,8.8,7.2,0,0],borderColor:"rgb(16, 185, 129)",backgroundColor:"rgba(16, 185, 129, 0.1)",tension:.4}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"Hours"}}}}})}if(w.value){const o=w.value.getContext("2d");C=new W(o,{type:"doughnut",data:{labels:["Development","Marketing","Sales","Support"],datasets:[{data:[35,25,20,20],backgroundColor:["rgb(59, 130, 246)","rgb(16, 185, 129)","rgb(245, 158, 11)","rgb(239, 68, 68)"]}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"}}}})}},F=()=>{setInterval(()=>{h.value=Math.floor(y.value*(.4+Math.random()*.3));const o=["Clocked in","Clocked out","Started break","Ended break"],s=["John Doe","Jane Smith","Mike Johnson","Alice Brown"];Math.random()>.7&&(liveActivities.value.unshift({id:Date.now(),user:{first_name:s[Math.floor(Math.random()*s.length)].split(" ")[0]},message:o[Math.floor(Math.random()*o.length)],timestamp:new Date}),liveActivities.value.length>10&&(liveActivities.value=liveActivities.value.slice(0,10)))},5e3)},J=()=>{E()},L=()=>{alert("Report export functionality will be implemented soon!")},N=o=>new Date(o).toLocaleTimeString();return(o,s)=>(g(),u("div",K,[t("div",Q,[t("div",{class:"mb-8"},[t("div",{class:"flex items-center justify-between"},[s[1]||(s[1]=t("div",null,[t("h1",{class:"text-3xl font-bold text-gray-900 mb-2"},"Admin Dashboard"),t("p",{class:"text-gray-600"},"Global overview of organization performance and activity")],-1)),t("div",{class:"flex items-center space-x-4"},[t("button",{onClick:J,class:"px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700"}," 🔄 Refresh "),t("button",{onClick:L,class:"px-4 py-2 bg-green-600 text-white text-sm font-medium rounded-lg hover:bg-green-700"}," 📊 Export Report ")])])]),t("div",X,[t("div",Y,[t("div",tt,[s[4]||(s[4]=t("div",{class:"p-3 bg-blue-100 rounded-lg"},[t("span",{class:"text-2xl"},"👥")],-1)),t("div",st,[s[2]||(s[2]=t("p",{class:"text-sm font-medium text-gray-500"},"Total Employees",-1)),t("p",et,a(y.value),1),s[3]||(s[3]=t("p",{class:"text-xs text-green-600"},"+12% from last month",-1))])])]),t("div",ot,[t("div",at,[s[7]||(s[7]=t("div",{class:"p-3 bg-blue-100 rounded-lg"},[t("span",{class:"text-2xl"},"💼")],-1)),t("div",rt,[s[5]||(s[5]=t("p",{class:"text-sm font-medium text-gray-500"},"Currently Working",-1)),t("p",nt,a(h.value),1),s[6]||(s[6]=t("p",{class:"text-xs text-blue-600"},"Clocked In",-1))])])]),t("div",lt,[t("div",it,[s[10]||(s[10]=t("div",{class:"p-3 bg-purple-100 rounded-lg"},[t("span",{class:"text-2xl"},"⏰")],-1)),t("div",dt,[s[8]||(s[8]=t("p",{class:"text-sm font-medium text-gray-500"},"Avg Work Hours",-1)),t("p",ct,a(A.value),1),s[9]||(s[9]=t("p",{class:"text-xs text-orange-600"},"Today",-1))])])]),t("div",mt,[t("div",gt,[s[13]||(s[13]=t("div",{class:"p-3 bg-orange-100 rounded-lg"},[t("span",{class:"text-2xl"},"📈")],-1)),t("div",ut,[s[11]||(s[11]=t("p",{class:"text-sm font-medium text-gray-500"},"Productivity",-1)),t("p",pt,a(Math.round(j.value))+"%",1),s[12]||(s[12]=t("p",{class:"text-xs text-green-600"},"+5% this week",-1))])])])]),t("div",xt,[t("div",bt,[s[14]||(s[14]=t("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Working Hours Trend",-1)),t("div",ht,[t("canvas",{ref_key:"hoursChart",ref:_},null,512)])]),t("div",vt,[s[15]||(s[15]=t("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Team Performance",-1)),t("div",ft,[t("canvas",{ref_key:"teamChart",ref:w},null,512)])])]),t("div",yt,[t("div",_t,[s[16]||(s[16]=t("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Top Performers",-1)),t("div",wt,[(g(!0),u(S,null,T(M.value,(e,r)=>(g(),u("div",{key:e.id,class:"flex items-center space-x-3"},[t("div",kt,[t("span",Ct,"#"+a(r+1),1)]),t("div",Dt,[t("p",St,a(e.name),1),t("p",Tt,a(e.hours)+" hours this week",1)])]))),128))])]),t("div",At,[s[17]||(s[17]=t("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Recent Alerts",-1)),t("div",Mt,[(g(!0),u(S,null,T(R.value,e=>(g(),u("div",{key:e.id,class:"flex items-start space-x-3"},[t("div",Rt,[t("span",{class:q(["w-2 h-2 rounded-full mt-2",e.type==="warning"?"bg-yellow-400":e.type==="error"?"bg-red-400":"bg-green-400"])},null,2)]),t("div",Ht,[t("p",Et,a(e.message),1),t("p",$t,a(N(e.timestamp)),1)])]))),128))])])]),t("div",It,[t("div",Pt,[s[18]||(s[18]=t("h3",{class:"text-lg font-semibold text-gray-900"},"Team Overview",-1)),t("button",{onClick:s[0]||(s[0]=e=>o.$router.push("/admin/teams")),class:"text-blue-600 hover:text-blue-800 text-sm font-medium"}," View All Teams → ")]),t("div",Wt,[(g(!0),u(S,null,T(H.value,e=>(g(),u("div",{key:e.id,class:"border border-gray-200 rounded-lg p-4"},[t("div",jt,[t("h4",Bt,a(e.name),1),t("span",Ot,a(e.memberCount)+" members",1)]),t("div",zt,[t("div",Ft,[s[19]||(s[19]=t("span",{class:"text-gray-500"},"Manager:",-1)),t("span",Jt,a(e.managerName),1)]),t("div",Lt,[s[20]||(s[20]=t("span",{class:"text-gray-500"},"Members:",-1)),t("span",Nt,a(e.memberCount),1)]),t("div",Ut,[s[21]||(s[21]=t("span",{class:"text-gray-500"},"Avg Hours:",-1)),t("span",Vt,a(e.averageHours),1)])])]))),128))])])])]))}};export{es as default};
