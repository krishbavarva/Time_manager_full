import{x as ne,r as n,f as A,g as ie,o as d,c as r,a as e,t as s,w as _,k as Q,d as ue,v as V,F as ce,i as pe,y as v,n as T,b as x,e as N,m as S}from"./index-621cd5fc.js";import{l as E,g as W,a as X,b as Y,c as Z}from"./leaveRequests-38ddcdf8.js";import"./http-f1abb376.js";const ve={class:"min-h-screen bg-gray-50 py-8 px-4 sm:px-6 lg:px-8"},me={class:"max-w-7xl mx-auto"},xe={class:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6"},ge={class:"bg-white rounded-xl shadow-sm border border-gray-200 p-6"},ye={class:"flex items-center"},be={class:"ml-4"},fe={class:"text-2xl font-bold text-gray-900"},_e={class:"bg-white rounded-xl shadow-sm border border-gray-200 p-6"},he={class:"flex items-center"},we={class:"ml-4"},ke={class:"text-2xl font-bold text-gray-900"},De={class:"bg-white rounded-xl shadow-sm border border-gray-200 p-6"},Re={class:"flex items-center"},Le={class:"ml-4"},Ae={class:"text-2xl font-bold text-gray-900"},Se={class:"bg-white rounded-xl shadow-sm border border-gray-200 p-6"},Ce={class:"flex items-center"},je={class:"ml-4"},Ve={class:"text-2xl font-bold text-gray-900"},Te={class:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6"},Ne={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},Ee={class:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden"},Fe={key:0,class:"p-8 text-center text-gray-500"},Ue={key:1,class:"p-8 text-center text-red-600"},qe={key:2,class:"p-8 text-center text-gray-500"},$e={key:3,class:"overflow-x-auto"},Me={class:"min-w-full divide-y divide-gray-200"},Pe={class:"bg-white divide-y divide-gray-200"},ze={class:"px-6 py-4 whitespace-nowrap"},Be={class:"flex items-center"},Ie={class:"flex-shrink-0 h-10 w-10"},Oe={class:"h-10 w-10 rounded-full bg-gray-300 flex items-center justify-center"},He={class:"text-sm font-medium text-gray-700"},Je={class:"ml-4"},Ge={class:"text-sm font-medium text-gray-900"},Ke={class:"text-sm text-gray-500"},Qe={class:"px-6 py-4 whitespace-nowrap"},We={class:"text-sm font-medium text-gray-900"},Xe={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Ye={key:0,class:"text-xs text-gray-500"},Ze={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},et={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},tt={class:"px-6 py-4 whitespace-nowrap"},st={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},at={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},lt={class:"flex items-center space-x-2"},ot=["onClick"],dt=["onClick"],rt=["onClick"],nt={key:0,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},it={class:"relative top-10 mx-auto p-5 border w-full max-w-2xl shadow-lg rounded-md bg-white"},ut={class:"mt-3"},ct={class:"flex items-center justify-between mb-6"},pt={class:"space-y-4"},vt={class:"grid grid-cols-2 gap-4"},mt={class:"text-sm text-gray-900"},xt={class:"text-sm text-gray-900"},gt={class:"grid grid-cols-2 gap-4"},yt={class:"text-sm text-gray-900"},bt={class:"grid grid-cols-2 gap-4"},ft={class:"text-sm text-gray-900"},_t={class:"text-sm text-gray-900"},ht={class:"grid grid-cols-2 gap-4"},wt={class:"text-sm text-gray-900"},kt={class:"text-sm text-gray-900"},Dt={class:"text-sm text-gray-900 bg-gray-50 p-3 rounded-md"},Rt={key:0},Lt={class:"text-sm text-gray-900 bg-blue-50 p-3 rounded-md"},At={key:1},St={class:"block text-sm font-medium text-gray-700"},Ct={class:"text-sm text-gray-900"},jt={class:"text-gray-500"},Vt={key:1,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},Tt={class:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white"},Nt={class:"mt-3"},Et={class:"text-lg font-medium text-gray-900 mb-4"},Ft={class:"mb-4"},Ut={class:"text-sm text-gray-600"},qt={class:"mb-4"},$t=["placeholder"],Mt={class:"flex justify-end space-x-3"},Pt={__name:"AdminLeaveRequestsView",setup(zt){const g=n([]),C=n(!1),b=n(""),h=n(""),w=n(""),k=n(""),D=n(""),o=n(null),R=n(!1),i=n(""),u=n(null),m=n(""),ee=n(JSON.parse(localStorage.getItem("currentUser")||"{}")),F=A(()=>{let a=g.value;if(h.value&&(a=a.filter(t=>t.status===h.value)),w.value&&(a=a.filter(t=>t.leave_type===w.value)),k.value){const t=k.value.toLowerCase();a=a.filter(c=>{var p,f;return`${((p=c.user)==null?void 0:p.first_name)||""} ${((f=c.user)==null?void 0:f.last_name)||""}`.toLowerCase().includes(t)})}if(D.value){const t=new Date(D.value);a=a.filter(c=>{const y=new Date(c.start_date),p=new Date(c.end_date);return y<=t&&t<=p||y.toDateString()===t.toDateString()||p.toDateString()===t.toDateString()})}return a}),te=A(()=>g.value.filter(a=>a.status==="pending").length),se=A(()=>g.value.filter(a=>a.status==="approved").length),ae=A(()=>g.value.filter(a=>a.status==="rejected").length),j=async()=>{C.value=!0,b.value="";try{const a=await E.list();g.value=a.data||[]}catch(a){console.error("Error loading leave requests:",a),b.value="Failed to load leave requests",S.error("Failed to load leave requests")}finally{C.value=!1}},le=a=>{o.value=a},oe=a=>{i.value="approve",u.value=a,m.value="",R.value=!0},de=a=>{i.value="reject",u.value=a,m.value="",R.value=!0},U=()=>{R.value=!1,i.value="",u.value=null,m.value=""},re=async()=>{if(u.value)try{i.value==="approve"?(await E.approve(u.value.id,m.value),S.success("Leave request approved successfully!")):(await E.reject(u.value.id,m.value),S.success("Leave request rejected successfully!")),await j(),U()}catch(a){console.error(`Error ${i.value}ing leave request:`,a),S.error(`Failed to ${i.value} leave request`)}},L=a=>a?new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"",q=a=>a?new Date(a).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"";return ie(()=>{if(ee.value.role!=="admin"){b.value="Access denied. Admin privileges required.";return}j()}),(a,t)=>{var c,y,p,f,$,M,P;return d(),r("div",ve,[e("div",me,[e("div",{class:"mb-8"},[e("div",{class:"flex items-center justify-between"},[t[6]||(t[6]=e("div",null,[e("h1",{class:"text-3xl font-bold text-gray-900 mb-2"},"Leave Request Management"),e("p",{class:"text-gray-600"},"Review and manage employee leave requests")],-1)),e("div",{class:"flex items-center space-x-4"},[e("button",{onClick:j,class:"px-4 py-2 bg-gray-600 text-white text-sm font-medium rounded-lg hover:bg-gray-700"}," ðŸ”„ Refresh ")])])]),e("div",xe,[e("div",ge,[e("div",ye,[t[8]||(t[8]=e("div",{class:"p-3 bg-yellow-100 rounded-lg"},[e("span",{class:"text-2xl"},"â³")],-1)),e("div",be,[t[7]||(t[7]=e("p",{class:"text-sm font-medium text-gray-500"},"Pending",-1)),e("p",fe,s(te.value),1)])])]),e("div",_e,[e("div",he,[t[10]||(t[10]=e("div",{class:"p-3 bg-green-100 rounded-lg"},[e("span",{class:"text-2xl"},"âœ…")],-1)),e("div",we,[t[9]||(t[9]=e("p",{class:"text-sm font-medium text-gray-500"},"Approved",-1)),e("p",ke,s(se.value),1)])])]),e("div",De,[e("div",Re,[t[12]||(t[12]=e("div",{class:"p-3 bg-red-100 rounded-lg"},[e("span",{class:"text-2xl"},"âŒ")],-1)),e("div",Le,[t[11]||(t[11]=e("p",{class:"text-sm font-medium text-gray-500"},"Rejected",-1)),e("p",Ae,s(ae.value),1)])])]),e("div",Se,[e("div",Ce,[t[14]||(t[14]=e("div",{class:"p-3 bg-blue-100 rounded-lg"},[e("span",{class:"text-2xl"},"ðŸ‘¥")],-1)),e("div",je,[t[13]||(t[13]=e("p",{class:"text-sm font-medium text-gray-500"},"Total Requests",-1)),e("p",Ve,s(g.value.length),1)])])])]),e("div",Te,[e("div",Ne,[e("div",null,[t[16]||(t[16]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Status",-1)),_(e("select",{"onUpdate:modelValue":t[0]||(t[0]=l=>h.value=l),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"},[...t[15]||(t[15]=[e("option",{value:""},"All Status",-1),e("option",{value:"pending"},"Pending",-1),e("option",{value:"approved"},"Approved",-1),e("option",{value:"rejected"},"Rejected",-1)])],512),[[Q,h.value]])]),e("div",null,[t[18]||(t[18]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Leave Type",-1)),_(e("select",{"onUpdate:modelValue":t[1]||(t[1]=l=>w.value=l),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"},[...t[17]||(t[17]=[ue('<option value="" data-v-636a1819>All Types</option><option value="sick" data-v-636a1819>Sick Leave</option><option value="vacation" data-v-636a1819>Vacation</option><option value="personal" data-v-636a1819>Personal Leave</option><option value="emergency" data-v-636a1819>Emergency Leave</option><option value="holiday" data-v-636a1819>Holiday</option>',6)])],512),[[Q,w.value]])]),e("div",null,[t[19]||(t[19]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Employee",-1)),_(e("input",{"onUpdate:modelValue":t[2]||(t[2]=l=>k.value=l),type:"text",placeholder:"Search by name...",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"},null,512),[[V,k.value]])]),e("div",null,[t[20]||(t[20]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Date Range",-1)),_(e("input",{"onUpdate:modelValue":t[3]||(t[3]=l=>D.value=l),type:"date",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"},null,512),[[V,D.value]])])])]),e("div",Ee,[t[22]||(t[22]=e("div",{class:"px-6 py-4 border-b border-gray-200"},[e("h2",{class:"text-lg font-semibold text-gray-900"},"Leave Requests")],-1)),C.value?(d(),r("div",Fe," Loading leave requests... ")):b.value?(d(),r("div",Ue,s(b.value),1)):F.value.length===0?(d(),r("div",qe," No leave requests found. ")):(d(),r("div",$e,[e("table",Me,[t[21]||(t[21]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Employee"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Leave Type"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Date Range"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Duration"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Total Days"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Submitted"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),e("tbody",Pe,[(d(!0),r(ce,null,pe(F.value,l=>{var z,B,I,O,H,J,G;return d(),r("tr",{key:l.id,class:"hover:bg-gray-50"},[e("td",ze,[e("div",Be,[e("div",Ie,[e("div",Oe,[e("span",He,s((B=(z=l.user)==null?void 0:z.first_name)==null?void 0:B[0])+s((O=(I=l.user)==null?void 0:I.last_name)==null?void 0:O[0]),1)])]),e("div",Je,[e("div",Ge,s((H=l.user)==null?void 0:H.first_name)+" "+s((J=l.user)==null?void 0:J.last_name),1),e("div",Ke,s((G=l.user)==null?void 0:G.email),1)])])]),e("td",Qe,[e("span",We,s(v(W)(l.leave_type)),1)]),e("td",Xe,[e("div",null,[e("div",null,s(L(l.start_date)),1),l.start_date!==l.end_date?(d(),r("div",Ye," to "+s(L(l.end_date)),1)):x("",!0)])]),e("td",Ze,s(v(X)(l.duration_type)),1),e("td",et,s(l.total_days)+" day"+s(l.total_days!==1?"s":""),1),e("td",tt,[e("span",{class:T(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",v(Y)(l.status)])},s(v(Z)(l.status)),3)]),e("td",st,s(q(l.inserted_at)),1),e("td",at,[e("div",lt,[e("button",{onClick:K=>le(l),class:"text-blue-600 hover:text-blue-800",title:"View Details"}," ðŸ‘ï¸ ",8,ot),l.status==="pending"?(d(),r("button",{key:0,onClick:K=>oe(l),class:"text-green-600 hover:text-green-800",title:"Approve"}," âœ… ",8,dt)):x("",!0),l.status==="pending"?(d(),r("button",{key:1,onClick:K=>de(l),class:"text-red-600 hover:text-red-800",title:"Reject"}," âŒ ",8,rt)):x("",!0)])])])}),128))])])]))])]),o.value?(d(),r("div",nt,[e("div",it,[e("div",ut,[e("div",ct,[t[23]||(t[23]=e("h3",{class:"text-xl font-medium text-gray-900"},"Leave Request Details",-1)),e("button",{onClick:t[4]||(t[4]=l=>o.value=null),class:"text-gray-400 hover:text-gray-600 text-2xl"}," âœ• ")]),e("div",pt,[e("div",vt,[e("div",null,[t[24]||(t[24]=e("label",{class:"block text-sm font-medium text-gray-700"},"Employee",-1)),e("p",mt,s((c=o.value.user)==null?void 0:c.first_name)+" "+s((y=o.value.user)==null?void 0:y.last_name),1)]),e("div",null,[t[25]||(t[25]=e("label",{class:"block text-sm font-medium text-gray-700"},"Email",-1)),e("p",xt,s((p=o.value.user)==null?void 0:p.email),1)])]),e("div",gt,[e("div",null,[t[26]||(t[26]=e("label",{class:"block text-sm font-medium text-gray-700"},"Leave Type",-1)),e("p",yt,s(v(W)(o.value.leave_type)),1)]),e("div",null,[t[27]||(t[27]=e("label",{class:"block text-sm font-medium text-gray-700"},"Status",-1)),e("span",{class:T(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",v(Y)(o.value.status)])},s(v(Z)(o.value.status)),3)])]),e("div",bt,[e("div",null,[t[28]||(t[28]=e("label",{class:"block text-sm font-medium text-gray-700"},"Start Date",-1)),e("p",ft,s(L(o.value.start_date)),1)]),e("div",null,[t[29]||(t[29]=e("label",{class:"block text-sm font-medium text-gray-700"},"End Date",-1)),e("p",_t,s(L(o.value.end_date)),1)])]),e("div",ht,[e("div",null,[t[30]||(t[30]=e("label",{class:"block text-sm font-medium text-gray-700"},"Duration",-1)),e("p",wt,s(v(X)(o.value.duration_type)),1)]),e("div",null,[t[31]||(t[31]=e("label",{class:"block text-sm font-medium text-gray-700"},"Total Days",-1)),e("p",kt,s(o.value.total_days)+" day"+s(o.value.total_days!==1?"s":""),1)])]),e("div",null,[t[32]||(t[32]=e("label",{class:"block text-sm font-medium text-gray-700"},"Reason",-1)),e("p",Dt,s(o.value.reason),1)]),o.value.admin_notes?(d(),r("div",Rt,[t[33]||(t[33]=e("label",{class:"block text-sm font-medium text-gray-700"},"Admin Notes",-1)),e("p",Lt,s(o.value.admin_notes),1)])):x("",!0),o.value.approved_by?(d(),r("div",At,[e("label",St,s(o.value.status==="approved"?"Approved by":"Processed by"),1),e("p",Ct,[N(s(o.value.approved_by.first_name)+" "+s(o.value.approved_by.last_name)+" ",1),e("span",jt,"on "+s(q(o.value.updated_at)),1)])])):x("",!0)])])])])):x("",!0),R.value?(d(),r("div",Vt,[e("div",Tt,[e("div",Nt,[e("h3",Et,s(i.value==="approve"?"Approve Leave Request":"Reject Leave Request"),1),e("div",Ft,[e("p",Ut,[N(s(i.value==="approve"?"Approve":"Reject")+" leave request for ",1),e("strong",null,s(($=(f=u.value)==null?void 0:f.user)==null?void 0:$.first_name)+" "+s((P=(M=u.value)==null?void 0:M.user)==null?void 0:P.last_name),1),t[34]||(t[34]=N("? ",-1))])]),e("div",qt,[t[35]||(t[35]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Admin Notes (Optional)",-1)),_(e("textarea",{"onUpdate:modelValue":t[5]||(t[5]=l=>m.value=l),rows:"3",placeholder:i.value==="approve"?"Add any notes about the approval...":"Provide reason for rejection...",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"},null,8,$t),[[V,m.value]])]),e("div",Mt,[e("button",{onClick:U,class:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50"}," Cancel "),e("button",{onClick:re,class:T(["px-4 py-2 text-sm font-medium text-white rounded-md",i.value==="approve"?"bg-green-600 hover:bg-green-700":"bg-red-600 hover:bg-red-700"])},s(i.value==="approve"?"Approve":"Reject"),3)])])])])):x("",!0)])}}},Ht=ne(Pt,[["__scopeId","data-v-636a1819"]]);export{Ht as default};
